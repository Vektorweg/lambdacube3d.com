var PS=PS||{};
PS.Prelude=function(){function a(a){return function(b){return[a].concat(b)}}function b(a){return function(b){for(var c=[],d=0,e=b.length;d<e;d++)c[d]=a(b[d]);return"["+c.join(",")+"]"}}function e(a){return function(b){return a===b}}function c(a){return function(b){return a!==b}}var d=function(){function a(){}a.value=new a;return a}(),h=function(){function a(){}a.value=new a;return a}(),f=function(){function a(){}a.value=new a;return a}(),g=function(a){this["<<<"]=a},n=function(a,b){this["__superclass_Prelude.Semigroupoid_0"]=a;
this.id=b},t=function(a){this.show=a},k=function(a,b,c,d){this["*"]=a;this["+"]=b;this.one=c;this.zero=d},q=function(a,b,c){this["/"]=a;this["__superclass_Prelude.Semiring_0"]=b;this.mod=c},r=function(a,b){this["-"]=a;this["__superclass_Prelude.Semiring_0"]=b},A=function(a,b){this["__superclass_Prelude.ModuloSemiring_1"]=a;this["__superclass_Prelude.Ring_0"]=b},l=function(a){this["__superclass_Prelude.DivisionRing_0"]=a},w=function(a,b){this["/="]=a;this["=="]=b},K=function(a,b){this["__superclass_Prelude.Eq_0"]=
a;this.compare=b},x=function(a,b,c,d,e,f,g){this[".&."]=a;this[".^."]=b;this[".|."]=c;this.complement=d;this.shl=e;this.shr=f;this.zshr=g},E=function(a,b,c){this["&&"]=a;this.not=b;this["||"]=c},m=function(a){this["<>"]=a},u=function(a){return a[">>="]},B=function(a){return a["<>"]},p=function(a){return a["<*>"]},F=function(a){return a["-"]},I=function(a){return a.zero},v=function(a){return function(b){return function(c){return function(d){return function(e){return d<e?a:d>e?c:b}}}}}(d.value)(f.value)(h.value),
L=new t(function(a){return JSON.stringify(a)}),M=new t(function(a){return a.toString()}),H=new k(function(a){return function(b){return a*b}},function(a){return function(b){return a+b}},1,0),G=new g(function(a){return function(b){return function(c){return a(b(c))}}}),D=new m(function(a){return function(b){return a+b}}),y=new r(function(a){return function(b){return a-b}},function(){return H}),z=function(a){return a.pure},J=function(a){return z(a["__superclass_Prelude.Applicative_0"]())},P=new q(function(a){return function(b){return a/
b}},function(){return H},function(a){return function(a){return 0}}),Q=new w(c,e),v=new K(function(){return Q},v),O=new w(c,e),R=new A(function(){return P},function(){return y}),U=new l(function(){return R}),S=new n(function(){return G},function(a){return a}),N=new E(function(a){return function(b){return a&&b}},function(a){return!a},function(a){return function(b){return a||b}}),V=new x(function(a){return function(b){return a&b}},function(a){return function(b){return a^b}},function(a){return function(b){return a|
b}},function(a){return~a},function(a){return function(b){return a<<b}},function(a){return function(b){return a>>b}},function(a){return function(b){return a>>>b}});return{Unit:function(a){return a},LT:d,GT:h,EQ:f,Semigroup:m,BoolLike:E,Bits:x,Ord:K,Eq:w,Num:l,DivisionRing:A,Ring:r,ModuloSemiring:q,Semiring:k,Monad:function(a,b){this["__superclass_Prelude.Applicative_0"]=a;this["__superclass_Prelude.Bind_1"]=b},Bind:function(a,b){this[">>="]=a;this["__superclass_Prelude.Apply_0"]=b},Applicative:function(a,
b){this["__superclass_Prelude.Apply_0"]=a;this.pure=b},Apply:function(a,b){this["<*>"]=a;this["__superclass_Prelude.Functor_0"]=b},Functor:function(a){this["<$>"]=a},Show:t,Category:n,Semigroupoid:g,unit:{},"++":function(a){return B(a)},"<>":B,not:function(a){return a.not},"||":function(a){return a["||"]},"&&":function(a){return a["&&"]},complement:function(a){return a.complement},".|.":function(a){return a[".|."]},">=":function(a){return function(b){return function(c){return(0,a.compare)(b)(c)instanceof
d?!1:!0}}},"<=":function(a){return function(b){return function(c){return(0,a.compare)(b)(c)instanceof h?!1:!0}}},"<":function(a){return function(b){return function(c){return(0,a.compare)(b)(c)instanceof d?!0:!1}}},compare:function(a){return a.compare},"/=":function(a){return a["/="]},"==":function(a){return a["=="]},negate:function(a){return function(b){return F(a)(I(a["__superclass_Prelude.Semiring_0"]()))(b)}},"-":F,"/":function(a){return a["/"]},"*":function(a){return a["*"]},zero:I,"+":function(a){return a["+"]},
ap:function(a){return function(b){return function(c){return u(a["__superclass_Prelude.Bind_1"]())(b)(function(b){return u(a["__superclass_Prelude.Bind_1"]())(c)(function(c){return J(a)(b(c))})})}}},"return":J,">>=":u,liftA1:function(a){return function(b){return function(c){return p(a["__superclass_Prelude.Apply_0"]())((0,a.pure)(b))(c)}}},pure:z,"<*>":p,"<$>":function(a){return a["<$>"]},show:function(a){return a.show},cons:a,":":a,"#":function(a){return function(b){return b(a)}},$:function(a){return function(b){return a(b)}},
id:function(a){return a.id},"<<<":function(a){return a["<<<"]},"const":function(a){return function(b){return a}},flip:function(a){return function(b){return function(c){return a(c)(b)}}},otherwise:!0,semigroupoidArr:G,categoryArr:S,showString:L,showNumber:M,showArray:function(a){return new t(b(a.show))},semiringNumber:H,ringNumber:y,moduloSemiringNumber:P,divisionRingNumber:R,numNumber:U,eqNumber:Q,eqBoolean:O,ordNumber:v,bitsNumber:V,boolLikeBoolean:N,semigroupString:D}}();PS=PS||{};
PS.Prelude_Unsafe=function(){return{unsafeIndex:function(a){return function(b){return a[b]}}}}();PS=PS||{};PS.$$Math=function(){return{pi:Math.PI,tan:Math.tan,sqrt:Math.sqrt,sin:Math.sin,floor:Math.floor,cos:Math.cos}}();PS=PS||{};PS.DefaultText=function(){return{defaultSrc:'\nclear = FrameBuffer $ (DepthImage @1 1000, ColorImage @1 navy)   -- ...\n\ntriangleRasterCtx = TriangleCtx CullNone PolygonFill NoOffset LastVertex\ncolorFragmentCtx = AccumulationContext (DepthOp Less True, ColorOp NoBlending (V4 True True True True))\n\nrasterizeWith = Rasterize\ntriangles = triangleRasterCtx\n\ncubeVertexStream = Fetch "stream4" Triangles (Attribute "position4" :: Vec 4 Float)\nmapFragments s fs = Accumulate colorFragmentCtx PassAll (\\a -> FragmentOutRastDepth $ fs a) s clear\ntransform s f =  Transform (\\v -> VertexOut (f v) 1 () (Smooth v)) s\n\nrotate\' v = (Uniform "MVP" :: Mat 4 4 Float) *. v\n\nmain =             cubeVertexStream         -- cube vertices\n    `transform`    (scale 0.5 . rotate\')    -- scale them\n     &             rasterizeWith triangles  -- rasterize\n    `mapFragments` id\n     &             ScreenOut                --  draw into screen\n'}}();
PS=PS||{};PS.Data_Time=function(){return{Milliseconds:function(a){return a}}}();PS=PS||{};
PS.Data_Function=function(){return{runFn7:function(a){return function(b){return function(e){return function(c){return function(d){return function(h){return function(f){return function(g){return a(b,e,c,d,h,f,g)}}}}}}}},runFn5:function(a){return function(b){return function(e){return function(c){return function(d){return function(h){return a(b,e,c,d,h)}}}}}},runFn4:function(a){return function(b){return function(e){return function(c){return function(d){return a(b,e,c,d)}}}}},runFn3:function(a){return function(b){return function(e){return function(c){return a(b,
e,c)}}}},runFn2:function(a){return function(b){return function(e){return a(b,e)}}},runFn1:function(a){return function(b){return a(b)}}}}();PS=PS||{};
PS.Control_Monad_Eff=function(){var a=PS.Prelude,b=new a.Monad(function(){return d},function(){return e}),e=new a.Bind(function(a){return function(b){return function(){return b(a())()}}},function(){return c}),c=new a.Apply(a.ap(b),function(){return h}),d=new a.Applicative(function(){return c},function(a){return function(){return a}}),h=new a.Functor(a.liftA1(d));return{runPure:function(a){return a()},functorEff:h,applyEff:c,applicativeEff:d,bindEff:e,monadEff:b}}();PS=PS||{};
PS.Control_Monad_Eff_Exception=function(){return{throwException:function(a){return function(){throw a;}},error:function(a){return Error(a)}}}();PS=PS||{};
PS.Control_Monad_Eff_Ref=function(){function a(a){return function(b){return function(){var d=b(a.value);a.value=d.newState;return d.retVal}}}var b=PS.Prelude;return{writeRef:function(a){return function(b){return function(){a.value=b;return{}}}},modifyRef:function(e){return function(c){return a(e)(function(a){return{newState:c(a),retVal:b.unit}})}},"modifyRef'":a,readRef:function(a){return function(){return a.value}},newRef:function(a){return function(){return{value:a}}}}}();PS=PS||{};
PS.Control_Monad_Eff_WebGL=function(){return{runWebGl_:function(a){return a}}}();PS=PS||{};PS.Debug_Trace=function(){return{trace:function(a){return function(){console.log(a);return{}}}}}();PS=PS||{};
PS.Control_Monad=function(){var a=PS.Prelude,b=function(c){return function(d){return function(e){return 0===d?a["return"](c)([]):a[">>="](c["__superclass_Prelude.Bind_1"]())(e)(function(f){return a[">>="](c["__superclass_Prelude.Bind_1"]())(b(c)(d-1)(e))(function(b){return a["return"](c)(a[":"](f)(b))})})}}},e=function(b){return function(d){return function(h){return function(f){if(0===f.length)return a["return"](b)(h);if(1<=f.length){var g=f.slice(1);return a[">>="](b["__superclass_Prelude.Bind_1"]())(d(h)(f[0]))(function(a){return e(b)(d)(a)(g)})}throw Error("Failed pattern match");
}}}};return{when:function(b){return function(d){return function(e){if(d)return e;if(!d)return a["return"](b)(a.unit);throw Error("Failed pattern match");}}},foldM:e,replicateM:b}}();PS=PS||{};PS.Control_Bind=function(){var a=PS.Prelude;return{"=<<":function(b){return function(e){return function(c){return a[">>="](b)(c)(e)}}}}}();PS=PS||{};
PS.Control_Apply=function(){var a=PS.Prelude;return{lift2:function(b){return function(e){return function(c){return function(d){return a["<*>"](b)(a["<$>"](b["__superclass_Prelude.Functor_0"]())(e)(c))(d)}}}},"*>":function(b){return function(e){return function(c){return a["<*>"](b)(a["<$>"](b["__superclass_Prelude.Functor_0"]())(a["const"](a.id(a.categoryArr)))(e))(c)}}}}}();PS=PS||{};PS.Control_Alt=function(){return{Alt:function(a,b){this["<|>"]=a;this["__superclass_Prelude.Functor_0"]=b},"<|>":function(a){return a["<|>"]}}}();
PS=PS||{};
PS.Data_Either=function(){var a=PS.Prelude,b=PS.Control_Alt,e=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),c=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),d=new a.Functor(function(a){return function(b){if(b instanceof e)return new e(b.value0);if(b instanceof c)return new c(a(b.value0));throw Error("Failed pattern match");}}),h=function(a){return function(b){return function(d){if(d instanceof e)return a(d.value0);if(d instanceof
c)return b(d.value0);throw Error("Failed pattern match");}}},f=new a.Apply(function(b){return function(f){if(b instanceof e)return new e(b.value0);if(b instanceof c)return a["<$>"](d)(b.value0)(f);throw Error("Failed pattern match");}},function(){return d}),g=new a.Bind(h(function(a){return function(b){return new e(a)}})(function(a){return function(b){return b(a)}}),function(){return f}),n=new a.Applicative(function(){return f},c.create),t=new a.Monad(function(){return n},function(){return g}),b=
new b.Alt(function(a){return function(b){return a instanceof e?b:a}},function(){return d});return{Left:e,Right:c,either:h,functorEither:d,applyEither:f,applicativeEither:n,altEither:b,bindEither:g,monadEither:t}}();PS=PS||{};
PS.WebSocket=function(){function a(a){return function(b){return function(d){return function(h){return function(){try{var f=new WebSocket(a);f.onerror=function(a){b.onError(f)(a.data)()};f.onopen=function(){b.onOpen(f)()};f.onclose=function(){b.onClose()};f.onmessage=function(a){b.onMessage(f)(a.data)()};return d(f)}catch(g){return console.log("exception"),console.log(g),console.log(g.type),h(g.type)}}}}}}var b=PS.Data_Either;return{send:function(a){return function(b){return function(){a.send(b)}}},
webSocket:function(e){return function(c){return a(e)(c)(b.Right.create)(b.Left.create)}},webSocketImpl:a}}();PS=PS||{};
PS.Data_Maybe=function(){var a=PS.Prelude,b=function(){function a(){}a.value=new a;return a}(),e=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),c=function(a){return function(c){return function(d){if(d instanceof b)return a;if(d instanceof e)return c(d.value0);throw Error("Failed pattern match");}}},d=c(!0)(a["const"](!1)),h=c(!1)(a["const"](!0)),f=new a.Functor(function(a){return function(c){return c instanceof e?new e(a(c.value0)):b.value}}),g=new a.Apply(function(c){return function(d){if(c instanceof
e)return a["<$>"](f)(c.value0)(d);if(c instanceof b)return b.value;throw Error("Failed pattern match");}},function(){return f}),n=new a.Bind(function(a){return function(c){if(a instanceof e)return c(a.value0);if(a instanceof b)return b.value;throw Error("Failed pattern match");}},function(){return g}),t=new a.Applicative(function(){return g},e.create);return{Nothing:b,Just:e,isNothing:d,isJust:h,maybe:c,functorMaybe:f,applyMaybe:g,applicativeMaybe:t,bindMaybe:n}}();PS=PS||{};
PS.Data_Array=function(){function a(a){return function(b){return a.concat(b)}}function b(a){return function(b){return function(c){return c.slice(a,b)}}}function e(a){return function(b){for(var c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a(b[e]);return d}}function c(a){return function(b){var c=~~a;b=~~b;for(var d=c>b?-1:1,e=[c],f=1;c!==b;)c+=d,e[f++]=c;return e}}function d(a){return function(b){return b.slice().sort(function(b,c){return a(b)(c)})}}var h=PS.Prelude,f=PS.Data_Maybe,g=function(a){return function(b){var c=
0>b||b>=a.length||b!==~~b;if(c)return f.Nothing.value;if(!c)return new f.Just(a[b]);throw Error("Failed pattern match");}},n=new h.Semigroup(a),t=new h.Functor(e);return{replicate:function(a){return function(b){for(var c=0<a?a:0,d=Array(c),e=0;e<c;e++)d[e]=b;return d}},sortBy:function(a){return function(b){return d(function(b){return function(c){c=a(b)(c);if(c instanceof h.GT)return 1;if(c instanceof h.EQ)return 0;if(c instanceof h.LT)return-1;throw Error("Failed pattern match");}})(b)}},zipWith:function(a){return function(b){return function(c){for(var d=
b.length<c.length?b.length:c.length,e=Array(d),f=0;f<d;f++)e[f]=a(b[f])(c[f]);return e}}},range:c,filter:function(a){return function(b){for(var c=0,d=[],e=0,f=b.length;e<f;e++)a(b[e])&&(d[c++]=b[e]);return d}},concatMap:function(a){return function(b){for(var c=[],d=0,e=b.length;d<e;d++)Array.prototype.push.apply(c,a(b[d]));return c}},updateAt:function(a){return function(b){return function(c){var d=~~a;if(0>d||d>=c.length)return c;c=c.slice();c[d]=b;return c}}},take:function(a){return b(0)(a)},concat:function(a){for(var b=
[],c=0,d=a.length;c<d;c++)b.push.apply(b,a[c]);return b},append:a,findIndex:function(a){return function(b){for(var c=0,d=b.length;c<d;c++)if(a(b[c]))return c;return-1}},length:function(a){return a.length},map:e,last:function(a){return g(a)(a.length-1)},head:function(a){return g(a)(0)},"..":c,"!!":g,functorArray:t,semigroupArray:n}}();PS=PS||{};
PS.Control_Monad_JQuery=function(){return{on:function(a){return function(b){return function(e){return function(){return e.on(a,function(a){b(a)(jQuery(this))()})}}}},setText:function(a){return function(b){return function(){return b.text(a)}}},getText:function(a){return function(){return a.text()}},body:function(){return jQuery(document.body)},append:function(a){return function(b){return function(){return b.append(a)}}},create:function(a){return function(){return jQuery(a)}},find:function(a){return function(b){return function(){return b.find(a)}}}}}();
PS=PS||{};PS.Data_Maybe_Unsafe=function(){var a=PS.Data_Maybe;return{fromJust:function(b){if(b instanceof a.Just)return b.value0;throw Error("Failed pattern match");}}}();PS=PS||{};PS.Data_Monoid=function(){var a=PS.Data_Array,b=function(a,b){this["__superclass_Prelude.Semigroup_0"]=a;this.mempty=b},e=new b(function(){return a.semigroupArray},[]);return{Monoid:b,mempty:function(a){return a.mempty},monoidArray:e}}();PS=PS||{};
PS.Data_Tuple=function(){var a=PS.Prelude,b=PS.Data_Array,e=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),b=b.zipWith(e.create),c=function(b){if(1<=b.length){var d=b.slice(1),d=c(d);return new e(a[":"](b[0].value0)(d.value0),a[":"](b[0].value1)(d.value1))}if(0===b.length)return new e([],[]);throw Error("Failed pattern match");},d=new a.Functor(function(a){return function(b){return new e(b.value0,a(b.value1))}});return{Tuple:e,
unzip:c,zip:b,uncurry:function(a){return function(b){return a(b.value0)(b.value1)}},snd:function(a){return a.value1},showTuple:function(b){return function(c){return new a.Show(function(d){return"Tuple ("+(a.show(b)(d.value0)+(") ("+(a.show(c)(d.value1)+")")))})}},functorTuple:d}}();PS=PS||{};
PS.Data_Foldable=function(){function a(a){return function(b){return function(c){for(var d=b,e=c.length-1;0<=e;--e)d=a(c[e])(d);return d}}}function b(a){return function(b){return function(c){for(var d=b,e=0,f=c.length;e<f;++e)d=a(d)(c[e]);return d}}}var e=PS.Prelude,c=PS.Data_Monoid,d=PS.Control_Apply,h=function(a,b,c){this.foldMap=a;this.foldl=b;this.foldr=c},f=function(a){return function(b){return function(c){return(0,b.foldr)(e["<<<"](e.semigroupoidArr)(d["*>"](a["__superclass_Prelude.Apply_0"]()))(c))(e.pure(a)(e.unit))}}},
g=function(a){return(0,a.foldl)(e["||"](e.boolLikeBoolean))(!1)},n=new h(function(a){return function(a){return function(b){return a(b.value1)}}},function(a){return function(b){return function(c){return a(b)(c.value1)}}},function(a){return function(b){return function(c){return a(c.value1)(b)}}}),t=new h(function(a){return function(b){return function(d){return(0,t.foldr)(function(c){return function(d){return e["<>"](a["__superclass_Prelude.Semigroup_0"]())(b(c))(d)}})(c.mempty(a))(d)}}},function(a){return function(c){return function(d){return b(a)(c)(d)}}},
function(b){return function(c){return function(d){return a(b)(c)(d)}}}),k=function(a){return(0,a.foldl)(e["&&"](e.boolLikeBoolean))(!0)};return{Foldable:h,foldlArray:b,foldrArray:a,all:function(a){return function(b){return e["<<<"](e.semigroupoidArr)(k(t))((0,a.foldMap)(c.monoidArray)(function(a){return[b(a)]}))}},any:function(a){return function(b){return e["<<<"](e.semigroupoidArr)(g(t))((0,a.foldMap)(c.monoidArray)(function(a){return[b(a)]}))}},or:g,and:k,for_:function(a){return function(b){return e.flip(f(a)(b))}},
traverse_:f,foldMap:function(a){return a.foldMap},foldl:function(a){return a.foldl},foldr:function(a){return a.foldr},foldableArray:t,foldableTuple:n}}();PS=PS||{};
PS.Data_Vector=function(){var a=PS.Prelude,b=PS.Data_Array,e=PS.Data_Foldable,c=PS.Data_Monoid,d=PS.Control_Apply,h=PS.$$Math,f=new a.Functor(function(c){return function(d){return a["<$>"](b.functorArray)(c)(d)}}),g=new e.Foldable(function(b){return function(d){return function(f){return e.foldr(g)(function(c){return function(e){return a["<>"](b["__superclass_Prelude.Semigroup_0"]())(d(c))(e)}})(c.mempty(b))(f)}}},function(a){return function(b){return function(c){return e.foldl(e.foldableArray)(a)(b)(c)}}},
function(a){return function(b){return function(c){return e.foldr(e.foldableArray)(a)(b)(c)}}}),n=function(b){return e.foldl(g)(a["+"](a.semiringNumber))(0)(a["<$>"](f)(function(a){return a*a})(b))},t=a["<<<"](a.semigroupoidArr)(h.sqrt)(n),k=function(b){var c=1/t(b);return a["<$>"](f)(function(a){return a*c})(b)},q=new a.Apply(function(a){return function(c){return b.zipWith(function(a){return function(b){return a(b)}})(a)(c)}},function(){return f}),r=function(b){return d.lift2(q)(a["-"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]()))};
return{Vec:function(a){return a},normalize:k,vlength:t,vlengthSquared:n,direction:function(b){return function(c){return k(r(a.numNumber)(b)(c))}},sub:r,functorVec:f,applyVec:q,foldableVector:g}}();PS=PS||{};PS.Data_Matrix=function(){return{Mat:function(a){return a}}}();PS=PS||{};
PS.Data_Vector3=function(){var a=PS.Prelude;return{cross:function(b){return function(e){return function(c){if(3===e.length&&3===c.length)return[a["-"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[1])(c[2]))(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[2])(c[1])),a["-"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[2])(c[0]))(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[0])(c[2])),
a["-"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.Ring_0"]())(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[0])(c[1]))(a["*"](b["__superclass_Prelude.DivisionRing_0"]()["__superclass_Prelude.ModuloSemiring_1"]()["__superclass_Prelude.Semiring_0"]())(e[1])(c[0]))];throw Error("Failed pattern match");}}},vec3:function(a){return function(e){return function(c){return[a,e,c]}}}}}();PS=PS||{};
PS.Data_StrMap_ST=function(){return{poke:function(a){return function(b){return function(e){return function(){a[b]=e;return a}}}},"new":function(){return{}}}}();PS=PS||{};
PS.Data_Traversable=function(){var a=PS.Prelude,b=PS.Data_Array,e=PS.Data_Tuple,c=PS.Data_Foldable,d=function(a){return a},h=function(a,b,c,d){this["__superclass_Data.Foldable.Foldable_1"]=a;this["__superclass_Prelude.Functor_0"]=b;this.sequence=c;this.traverse=d},f=new h(function(){return c.foldableTuple},function(){return e.functorTuple},function(b){return function(c){return a["<$>"](b["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(e.Tuple.create(c.value0))(c.value1)}},function(b){return function(c){return function(d){return a["<$>"](b["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(e.Tuple.create(d.value0))(c(d.value1))}}}),
g=function(a){return a},n=new h(function(){return c.foldableArray},function(){return b.functorArray},function(b){return function(c){if(0===c.length)return a.pure(b)([]);if(1<=c.length){var d=c.slice(1);return a["<*>"](b["__superclass_Prelude.Apply_0"]())(a["<$>"](b["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(a[":"])(c[0]))((0,n.sequence)(b)(d))}throw Error("Failed pattern match");}},function(b){return function(c){return function(d){if(0===d.length)return a.pure(b)([]);if(1<=
d.length){var e=d.slice(1);return a["<*>"](b["__superclass_Prelude.Apply_0"]())(a["<$>"](b["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(a[":"])(c(d[0])))((0,n.traverse)(b)(c)(e))}throw Error("Failed pattern match");}}}),t=new a.Functor(function(a){return function(b){return d(function(c){c=b(c);return new e.Tuple(c.value0,a(c.value1))})}}),k=new a.Apply(function(a){return function(b){return d(function(c){c=a(c);var d=b(c.value0);return new e.Tuple(d.value0,c.value1(d.value1))})}},
function(){return t}),q=new a.Applicative(function(){return k},function(a){return d(function(b){return new e.Tuple(b,a)})}),r=function(a){return function(b){return function(c){return function(e){return g((0,a.traverse)(q)(function(a){return d(function(c){return b(c)(a)})})(e))(c)}}}};return{Traversable:h,mapAccumL:r,scanl:function(a){return function(b){return function(c){return function(d){return e.snd(r(a)(function(a){return function(c){c=b(a)(c);return new e.Tuple(c,c)}})(c)(d))}}}},"for":function(a){return function(b){return function(c){return function(d){return(0,b.traverse)(a)(d)(c)}}}},
sequence:function(a){return a.sequence},traverse:function(a){return a.traverse},traversableArray:n,traversableTuple:f}}();PS=PS||{};
PS.Data_Map=function(){var a=PS.Prelude,b=PS.Data_Array,e=function(){function a(){}a.value=new a;return a}(),c=function(){function a(b,c,d,e){this.value0=b;this.value1=c;this.value2=d;this.value3=e}a.create=function(b){return function(c){return function(d){return function(e){return new a(b,c,d,e)}}}};return a}(),d=function(){function a(b,c,d,e,f,g,h){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f;this.value5=g;this.value6=h}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return function(h){return new a(b,
c,d,e,f,g,h)}}}}}}};return a}(),h=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),f=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),g=function(){function a(b,c,d,e,f,g){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f;this.value5=g}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return new a(b,
c,d,e,f,g)}}}}}};return a}(),n=function(){function a(b,c,d,e,f,g){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f;this.value5=g}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return new a(b,c,d,e,f,g)}}}}}};return a}(),t=function(){function a(b,c,d,e,f,g){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f;this.value5=g}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return new a(b,
c,d,e,f,g)}}}}}};return a}(),k=function(){function a(b,c,d,e){this.value0=b;this.value1=c;this.value2=d;this.value3=e}a.create=function(b){return function(c){return function(d){return function(e){return new a(b,c,d,e)}}}};return a}(),q=function(f){if(f instanceof e)return[];if(f instanceof c)return a["++"](b.semigroupArray)(q(f.value0))(a["++"](b.semigroupArray)([f.value2])(q(f.value3)));if(f instanceof d)return a["++"](b.semigroupArray)(q(f.value0))(a["++"](b.semigroupArray)([f.value2])(a["++"](b.semigroupArray)(q(f.value3))(a["++"](b.semigroupArray)([f.value5])(q(f.value6)))));
throw Error("Failed pattern match");},r=function(a){return function(a){return function(b){var e=a;a:for(;;){if(0===e.length)return b;if(1<=e.length){var k=e.slice(1);if(e[0]instanceof h){b=new c(b,e[0].value0,e[0].value1,e[0].value2);e=k;continue a}}if(1<=e.length&&(k=e.slice(1),e[0]instanceof f)){b=new c(e[0].value0,e[0].value1,e[0].value2,b);e=k;continue a}if(1<=e.length&&(k=e.slice(1),e[0]instanceof g)){b=new d(b,e[0].value0,e[0].value1,e[0].value2,e[0].value3,e[0].value4,e[0].value5);e=k;continue a}if(1<=
e.length&&(k=e.slice(1),e[0]instanceof n)){b=new d(e[0].value0,e[0].value1,e[0].value2,b,e[0].value3,e[0].value4,e[0].value5);e=k;continue a}if(1<=e.length&&(k=e.slice(1),e[0]instanceof t)){b=new d(e[0].value0,e[0].value1,e[0].value2,e[0].value3,e[0].value4,e[0].value5,b);e=k;continue a}throw Error("Failed pattern match");}}}};return{values:q,insert:function(b){var q=function(a){return function(b){return function(e){var q=a,m=b;a:for(;;){if(0===m.length)return new c(e.value0,e.value1,e.value2,e.value3);
if(1<=m.length){var l=m.slice(1);if(m[0]instanceof h)return r(q)(l)(new d(e.value0,e.value1,e.value2,e.value3,m[0].value0,m[0].value1,m[0].value2))}if(1<=m.length&&(l=m.slice(1),m[0]instanceof f))return r(q)(l)(new d(m[0].value0,m[0].value1,m[0].value2,e.value0,e.value1,e.value2,e.value3));if(1<=m.length&&(l=m.slice(1),m[0]instanceof g)){e=new k(new c(e.value0,e.value1,e.value2,e.value3),m[0].value0,m[0].value1,new c(m[0].value2,m[0].value3,m[0].value4,m[0].value5));m=l;continue a}if(1<=m.length&&
(l=m.slice(1),m[0]instanceof n)){e=new k(new c(m[0].value0,m[0].value1,m[0].value2,e.value0),e.value1,e.value2,new c(e.value3,m[0].value3,m[0].value4,m[0].value5));m=l;continue a}if(1<=m.length&&(l=m.slice(1),m[0]instanceof t)){e=new k(new c(m[0].value0,m[0].value1,m[0].value2,m[0].value3),m[0].value4,m[0].value5,new c(e.value0,e.value1,e.value2,e.value3));m=l;continue a}throw Error("Failed pattern match");}}}};return function(b){return function(A){return function(x){return function(E){return function(m){var u=
b,B=A,p=x,F=E;a:for(;;){if(m instanceof e)return q(u)(B)(new k(e.value,p,F,e.value));if(m instanceof c&&a["=="](u["__superclass_Prelude.Eq_0"]())(p)(m.value1))return r(u)(B)(new c(m.value0,p,F,m.value3));if(m instanceof c&&a["<"](u)(p)(m.value1)){B=a[":"](new h(m.value1,m.value2,m.value3))(B);m=m.value0;continue a}if(m instanceof c){B=a[":"](new f(m.value0,m.value1,m.value2))(B);m=m.value3;continue a}if(m instanceof d&&a["=="](u["__superclass_Prelude.Eq_0"]())(p)(m.value1))return r(u)(B)(new d(m.value0,
p,F,m.value3,m.value4,m.value5,m.value6));if(m instanceof d&&a["=="](u["__superclass_Prelude.Eq_0"]())(p)(m.value4))return r(u)(B)(new d(m.value0,m.value1,m.value2,m.value3,p,F,m.value6));if(m instanceof d&&a["<"](u)(p)(m.value1)){B=a[":"](new g(m.value1,m.value2,m.value3,m.value4,m.value5,m.value6))(B);m=m.value0;continue a}if(m instanceof d&&a["<"](u)(m.value1)(p)&&a["<="](u)(p)(m.value4)){B=a[":"](new n(m.value0,m.value1,m.value2,m.value4,m.value5,m.value6))(B);m=m.value3;continue a}if(m instanceof
d){B=a[":"](new t(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5))(B);m=m.value6;continue a}throw Error("Failed pattern match");}}}}}}(b)([])},empty:e.value}}();PS=PS||{};
PS.Data_StrMap=function(){function a(a){return function(b){return function(c){return function(d){function e(a){return function(c){return b(c)(a)(d[a])}}for(var f in d)c=a(c)(e(f));return c}}}}function b(a){return function(b){for(var c in b)if(!a(c)(b[c]))return!1;return!0}}function e(a,b,c,d){return c in d?b(d[c]):a}function c(a){return function(b){var c=[],d;for(d in b)c.push(a(d)(b[d]));return c}}var d=PS.Control_Monad_Eff,h=PS.Prelude,f=PS.Data_Function,g=PS.Data_Monoid,n=PS.Data_Foldable,t=PS.Data_Tuple,
k=PS.Data_Traversable,q=PS.Data_Maybe,r=PS.Data_StrMap_ST,A=PS.Data_Array,l={},w=Object.keys||c(function(a){return function(){return a}}),K=c(function(a){return function(a){return a}}),x=c(t.Tuple.create),E=function(a){return function(){var b={},c;for(c in a)b[c]=a[c];return b}},m=function(a){return d.runPure(a)},u=function(a){return function(b){return m(function(){var c=r["new"]();r.poke(c)(a)(b)();return c})}},B=function(a){return function(b){return m(function(){var c=E(b)();a(c)();return c})}},
p=f.runFn4(e)(!1)(h["const"](!0)),f=f.runFn4(e)(q.Nothing.value)(q.Just.create),F=function(a){return function(c){return function(d){return b(function(b){return function(c){return e(!1,h["=="](a)(c),b,d)}})(c)}}},I=new h.Functor(function(a){return function(b){var c={},d;for(d in b)c[d]=a(b[d]);return c}}),v=function(b){return function(c){return function(d){return a(h[">>="](b["__superclass_Prelude.Bind_1"]()))(c)(h.pure(b["__superclass_Prelude.Applicative_0"]())(d))}}},L=function(a){return B(function(b){return v(d.monadEff)(r.poke)(b)(a)})},
M=a(h["#"]),H=function(a){return function(b){return M(function(c){return function(d){return function(e){return h["<>"](a["__superclass_Prelude.Semigroup_0"]())(c)(b(d)(e))}}})(g.mempty(a))}},G=new n.Foldable(function(a){return function(b){return H(a)(h["const"](b))}},function(a){return M(function(b){return function(c){return a(b)}})},function(a){return function(b){return function(c){return n.foldr(n.foldableArray)(a)(b)(K(c))}}}),D=new k.Traversable(function(){return G},function(){return I},function(a){return k.traverse(D)(a)(h.id(h.categoryArr))},
function(a){return function(b){return function(c){return n.foldr(n.foldableArray)(function(b){return function(c){return h["<*>"](a["__superclass_Prelude.Apply_0"]())(h["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(L)(b))(c)}})(h.pure(a)(l))(h["<$>"](A.functorArray)(h["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(t.uncurry(u)))(h["<$>"](A.functorArray)(k.traverse(k.traversableTuple)(a)(b))(x(c))))}}}),y=function(a){return new h.Eq(function(b){return function(c){return!h["=="](y(a))(b)(c)}},
function(b){return function(c){return F(a)(b)(c)&&F(a)(c)(b)}})};return{runST:function(a){return a},thawST:E,all:b,foldM:v,foldMap:H,fold:M,isSubmap:F,union:L,values:K,keys:w,member:p,fromList:function(a){return m(function(){var b=r["new"]();n.for_(d.applicativeEff)(n.foldableArray)(a)(function(a){return r.poke(b)(a.value0)(a.value1)})();return b})},toList:x,lookup:f,singleton:u,size:function(a){var b=0,c;for(c in a)++b;return b},empty:l,functorStrMap:I,foldableStrMap:G,traversableStrMap:D,eqStrMap:y,
showStrMap:function(a){return new h.Show(function(b){return"fromList "+h.show(h.showArray(t.showTuple(h.showString)(a)))(x(b))})}}}();PS=PS||{};PS.Data_StrMap_Unsafe=function(){return{unsafeIndex:function(a){return function(b){return a[b]}}}}();PS=PS||{};
PS.Data_Matrix4=function(){var a=PS.Prelude,b=PS.Data_Vector,e=PS.$$Math,c=PS.Data_Vector3,d=function(a){return function(b){if(16===a.length&&16===b.length)return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+
a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]];throw Error("Failed pattern match");}},h=function(a){return function(b){return function(c){return function(d){return function(e){return function(h){return[2*
e/(b-a),0,0,0,0,2*e/(d-c),0,0,(b+a)/(b-a),(d+c)/(d-c),-(h+e)/(h-e),-1,0,0,-2*h*e/(h-e),0]}}}}}};return{makeLookAt:function(e){return function(g){return function(h){if(3===e.length){var t=b.direction(e)(g);if(3===t.length&&(h=b.normalize(c.cross(a.numNumber)(h)(t)),3===h.length)){var k=b.normalize(c.cross(a.numNumber)(t)(h));if(3===k.length){var q=[1,0,0,0,0,1,0,0,0,0,1,0,-e[0],-e[1],-e[2],1];return d([h[0],k[0],t[0],0,h[1],k[1],t[1],0,h[2],k[2],t[2],0,0,0,0,1])(q)}}}throw Error("Failed pattern match");
}}},makeRotate:function(a){return function(c){c=b.normalize(c);if(3===c.length){var d=e.sin(a),h=e.cos(a),k=1-h;return[c[0]*c[0]*k+h,c[1]*c[0]*k+c[2]*d,c[2]*c[0]*k-c[1]*d,0,c[0]*c[1]*k-c[2]*d,c[1]*c[1]*k+h,c[1]*c[2]*k+c[0]*d,0,c[0]*c[2]*k+c[1]*d,c[1]*c[2]*k-c[0]*d,c[2]*c[2]*k+h,0,0,0,0,1]}throw Error("Failed pattern match");}},mul:d,makePerspective:function(a){return function(b){return function(c){return function(d){var k=c*e.tan(a*e.pi/360),q=-k,r=k*b;return h(q*b)(r)(q)(k)(c)(d)}}}},makeFrustum:h}}();
PS=PS||{};PS.Data_TypedArray=function(){return{asFloat32Array:function(a){return new Float32Array(a)},asInt32Array:function(a){return new Int32Array(a)}}}();PS=PS||{};
PS.Graphics_WebGLRaw=function(){return{viewport_:function(a){return function(b){return function(e){return function(c){return function(){gl.viewport(a,b,e,c)}}}}},vertexAttribPointer_:function(a){return function(b){return function(e){return function(c){return function(d){return function(h){return function(){gl.vertexAttribPointer(a,b,e,c,d,h)}}}}}}},vertexAttrib4f_:function(a){return function(b){return function(e){return function(c){return function(d){return function(){gl.vertexAttrib4f(a,b,e,c,d)}}}}}},
vertexAttrib3f_:function(a){return function(b){return function(e){return function(c){return function(){gl.vertexAttrib3f(a,b,e,c)}}}}},vertexAttrib2f_:function(a){return function(b){return function(e){return function(){gl.vertexAttrib2f(a,b,e)}}}},vertexAttrib1f_:function(a){return function(b){return function(){gl.vertexAttrib1f(a,b)}}},useProgram_:function(a){return function(){gl.useProgram(a)}},uniformMatrix4fv_:function(a){return function(b){return function(e){return function(){gl.uniformMatrix4fv(a,
b,e)}}}},uniformMatrix3fv_:function(a){return function(b){return function(e){return function(){gl.uniformMatrix3fv(a,b,e)}}}},uniformMatrix2fv_:function(a){return function(b){return function(e){return function(){gl.uniformMatrix2fv(a,b,e)}}}},uniform4iv_:function(a){return function(b){return function(){gl.uniform4iv(a,b)}}},uniform4fv_:function(a){return function(b){return function(){gl.uniform4fv(a,b)}}},uniform3iv_:function(a){return function(b){return function(){gl.uniform3iv(a,b)}}},uniform3fv_:function(a){return function(b){return function(){gl.uniform3fv(a,
b)}}},uniform2iv_:function(a){return function(b){return function(){gl.uniform2iv(a,b)}}},uniform2fv_:function(a){return function(b){return function(){gl.uniform2fv(a,b)}}},uniform1iv_:function(a){return function(b){return function(){gl.uniform1iv(a,b)}}},uniform1i_:function(a){return function(b){return function(){gl.uniform1i(a,b)}}},uniform1fv_:function(a){return function(b){return function(){gl.uniform1fv(a,b)}}},texParameteri_:function(a){return function(b){return function(e){return function(){gl.texParameteri(a,
b,e)}}}},shaderSource_:function(a){return function(b){return function(){gl.shaderSource(a,b)}}},polygonOffset_:function(a){return function(b){return function(){gl.polygonOffset(a,b)}}},linkProgram_:function(a){return function(){gl.linkProgram(a)}},lineWidth_:function(a){return function(){gl.lineWidth(a)}},getUniformLocation_:function(a){return function(b){return function(){var e=gl.getUniformLocation(a,b);if(void 0===e)throw"Undefined in  getUniformLocation";return e}}},getShaderInfoLog_:function(a){return function(){var b=
gl.getShaderInfoLog(a);if(void 0===b)throw"Undefined in  getShaderInfoLog";return b}},getShaderParameter_:function(a){return function(b){return function(){var e=gl.getShaderParameter(a,b);if(void 0===e)throw"Undefined in  getShaderParameter";return e}}},getProgramInfoLog_:function(a){return function(){var b=gl.getProgramInfoLog(a);if(void 0===b)throw"Undefined in  getProgramInfoLog";return b}},getProgramParameter_:function(a){return function(b){return function(){var e=gl.getProgramParameter(a,b);
if(void 0===e)throw"Undefined in  getProgramParameter";return e}}},getAttribLocation_:function(a){return function(b){return function(){var e=gl.getAttribLocation(a,b);if(void 0===e)throw"Undefined in  getAttribLocation";return e}}},frontFace_:function(a){return function(){gl.frontFace(a)}},framebufferTexture2D_:function(a){return function(b){return function(e){return function(c){return function(d){return function(){gl.framebufferTexture2D(a,b,e,c,d)}}}}}},enableVertexAttribArray_:function(a){return function(){gl.enableVertexAttribArray(a)}},
enable_:function(a){return function(){gl.enable(a)}},drawElements_:function(a){return function(b){return function(e){return function(c){return function(){gl.drawElements(a,b,e,c)}}}}},drawArrays_:function(a){return function(b){return function(e){return function(){gl.drawArrays(a,b,e)}}}},disableVertexAttribArray_:function(a){return function(){gl.disableVertexAttribArray(a)}},disable_:function(a){return function(){gl.disable(a)}},depthMask_:function(a){return function(){gl.depthMask(a)}},depthFunc_:function(a){return function(){gl.depthFunc(a)}},
deleteShader_:function(a){return function(){gl.deleteShader(a)}},deleteProgram_:function(a){return function(){gl.deleteProgram(a)}},cullFace_:function(a){return function(){gl.cullFace(a)}},createTexture_:function(){var a=gl.createTexture();if(void 0===a)throw"Undefined in  createTexture";return a},createShader_:function(a){return function(){var b=gl.createShader(a);if(void 0===b)throw"Undefined in  createShader";return b}},createProgram_:function(){var a=gl.createProgram();if(void 0===a)throw"Undefined in  createProgram";
return a},createFramebuffer_:function(){var a=gl.createFramebuffer();if(void 0===a)throw"Undefined in  createFramebuffer";return a},createBuffer_:function(){var a=gl.createBuffer();if(void 0===a)throw"Undefined in  createBuffer";return a},compileShader_:function(a){return function(){gl.compileShader(a)}},colorMask_:function(a){return function(b){return function(e){return function(c){return function(){gl.colorMask(a,b,e,c)}}}}},clearStencil_:function(a){return function(){gl.clearStencil(a)}},clearDepth_:function(a){return function(){gl.clearDepth(a)}},
clearColor_:function(a){return function(b){return function(e){return function(c){return function(){gl.clearColor(a,b,e,c)}}}}},clear_:function(a){return function(){gl.clear(a)}},blendFuncSeparate_:function(a){return function(b){return function(e){return function(c){return function(){gl.blendFuncSeparate(a,b,e,c)}}}}},blendEquationSeparate_:function(a){return function(b){return function(){gl.blendEquationSeparate(a,b)}}},blendColor_:function(a){return function(b){return function(e){return function(c){return function(){gl.blendColor(a,
b,e,c)}}}}},bindTexture_:function(a){return function(b){return function(){gl.bindTexture(a,b)}}},bindFramebuffer_:function(a){return function(b){return function(){gl.bindFramebuffer(a,b)}}},bindBuffer_:function(a){return function(b){return function(){gl.bindBuffer(a,b)}}},attachShader_:function(a){return function(b){return function(){gl.attachShader(a,b)}}},activeTexture_:function(a){return function(){gl.activeTexture(a)}},getExtension_:function(a){return function(){var b=gl.getExtension(a);if(void 0===
b)throw"Undefined in  getExtension";return b}},_NONE:0,_DEPTH_ATTACHMENT:36096,_COLOR_ATTACHMENT0:36064,_FRAMEBUFFER:36160,_COMPILE_STATUS:35713,_MIRRORED_REPEAT:33648,_CLAMP_TO_EDGE:33071,_REPEAT:10497,_TEXTURE0:33984,_TEXTURE_WRAP_T:10243,_TEXTURE_WRAP_S:10242,_TEXTURE_MIN_FILTER:10241,_TEXTURE_MAG_FILTER:10240,_LINEAR_MIPMAP_LINEAR:9987,_NEAREST_MIPMAP_LINEAR:9986,_LINEAR_MIPMAP_NEAREST:9985,_NEAREST_MIPMAP_NEAREST:9984,_LINEAR:9729,_NEAREST:9728,_ALWAYS:519,_GEQUAL:518,_NOTEQUAL:517,_GREATER:516,
_LEQUAL:515,_EQUAL:514,_LESS:513,_NEVER:512,_LINK_STATUS:35714,_VERTEX_SHADER:35633,_FRAGMENT_SHADER:35632,_RGBA:6408,_DEPTH_COMPONENT:6402,_FLOAT:5126,_UNSIGNED_SHORT:5123,_SHORT:5122,_UNSIGNED_BYTE:5121,_BYTE:5120,_CCW:2305,_CW:2304,_POLYGON_OFFSET_FILL:32823,_DEPTH_TEST:2929,_STENCIL_TEST:2960,_BLEND:3042,_CULL_FACE:2884,_TEXTURE_2D:3553,_BACK:1029,_FRONT:1028,_STATIC_DRAW:35044,_ELEMENT_ARRAY_BUFFER:34963,_ARRAY_BUFFER:34962,_ONE_MINUS_CONSTANT_ALPHA:32772,_CONSTANT_ALPHA:32771,_ONE_MINUS_CONSTANT_COLOR:32770,
_CONSTANT_COLOR:32769,_FUNC_REVERSE_SUBTRACT:32779,_FUNC_SUBTRACT:32778,_FUNC_ADD:32774,_SRC_ALPHA_SATURATE:776,_ONE_MINUS_DST_COLOR:775,_DST_COLOR:774,_ONE_MINUS_DST_ALPHA:773,_DST_ALPHA:772,_ONE_MINUS_SRC_ALPHA:771,_SRC_ALPHA:770,_ONE_MINUS_SRC_COLOR:769,_SRC_COLOR:768,_ONE:1,_ZERO:0,_TRIANGLE_FAN:6,_TRIANGLE_STRIP:5,_TRIANGLES:4,_LINE_STRIP:3,_LINE_LOOP:2,_LINES:1,_POINTS:0,_COLOR_BUFFER_BIT:16384,_STENCIL_BUFFER_BIT:1024,_DEPTH_BUFFER_BIT:256}}();PS=PS||{};PS.Data_Date=function(){return{nowEpochMilliseconds:function(){return Date.now()}}}();
PS=PS||{};
PS.Graphics_WebGL=function(){function a(a){return function(b){return function(){var c=document.getElementById(a);try{gl=c.getContext("webgl",b)||c.getContext("experimental-webgl",b)}catch(d){return!1}return gl?!0:(gl=null,!1)}}}function b(a){return function(){return document.getElementById(a).width}}function e(a){return function(){return document.getElementById(a).height}}var c=PS.Control_Monad_Eff_WebGL,d={alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,preferLowPowerToHighPerformance:!1,
failIfMajorPerformanceCaveat:!1};return{getCanvasHeight:function(a){return e(a.canvasName)},getCanvasWidth:function(a){return b(a.canvasName)},runWebGL:function(b){return function(e){return function(g){var n={canvasName:b};return function(){var t=a(b)(d)();if(t)t=c.runWebGl_(g(n));else{if(t)throw Error("Failed pattern match");t=e("Unable to initialize WebGL. Your browser may not support it.")}return t()}}}},defContextAttributes:d}}();PS=PS||{};
PS.IR=function(){var a=PS.Prelude,b=function(){function a(b,ia,c,d){this.value0=b;this.value1=ia;this.value2=c;this.value3=d}a.create=function(b){return function(c){return function(d){return function(e){return new a(b,c,d,e)}}}};return a}(),e=function(){function a(b,ia,c){this.value0=b;this.value1=ia;this.value2=c}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),c=function(){function a(b,ia){this.value0=b;this.value1=ia}a.create=function(b){return function(c){return new a(b,
c)}};return a}(),d=function(){function a(){}a.value=new a;return a}(),h=function(){function a(){}a.value=new a;return a}(),f=function(){function a(){}a.value=new a;return a}(),g=function(){function a(){}a.value=new a;return a}(),n=function(){function a(){}a.value=new a;return a}(),t=function(){function a(){}a.value=new a;return a}(),k=function(){function a(){}a.value=new a;return a}(),q=function(){function a(){}a.value=new a;return a}(),r=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),A=function(){function a(){}a.value=new a;return a}(),l=function(){function a(){}a.value=new a;return a}(),w=function(){function a(){}a.value=new a;return a}(),K=function(){function a(){}a.value=new a;return a}(),x=function(){function a(){}a.value=new a;return a}(),E=function(){function a(){}a.value=new a;return a}(),m=function(){function a(){}a.value=new a;return a}(),u=function(){function a(){}a.value=new a;return a}(),B=function(){function a(){}a.value=new a;return a}(),p=function(){function a(){}
a.value=new a;return a}(),F=function(){function a(){}a.value=new a;return a}(),I=function(){function a(){}a.value=new a;return a}(),v=function(){function a(){}a.value=new a;return a}(),L=function(){function a(){}a.value=new a;return a}(),M=function(){function a(){}a.value=new a;return a}(),H=function(){function a(){}a.value=new a;return a}(),G=function(){function a(){}a.value=new a;return a}(),D=function(){function a(){}a.value=new a;return a}(),y=function(){function a(){}a.value=new a;return a}(),
z=function(){function a(){}a.value=new a;return a}(),J=function(){function a(){}a.value=new a;return a}(),P=function(){function a(){}a.value=new a;return a}(),Q=function(){function a(){}a.value=new a;return a}(),O=function(){function a(){}a.value=new a;return a}(),R=function(){function a(){}a.value=new a;return a}(),U=function(){function a(){}a.value=new a;return a}(),S=function(){function a(){}a.value=new a;return a}(),N=function(){function a(){}a.value=new a;return a}(),V=function(){function a(){}
a.value=new a;return a}(),Z=function(){function a(){}a.value=new a;return a}(),aa=function(){function a(){}a.value=new a;return a}(),W=function(){function a(){}a.value=new a;return a}(),X=function(){function a(){}a.value=new a;return a}(),Y=function(){function a(){}a.value=new a;return a}(),ba=function(){function a(){}a.value=new a;return a}(),ca=function(){function a(){}a.value=new a;return a}(),da=function(){function a(){}a.value=new a;return a}(),ea=function(){function a(){}a.value=new a;return a}(),
fa=function(){function a(){}a.value=new a;return a}(),ga=function(){function a(){}a.value=new a;return a}(),ha=function(){function a(){}a.value=new a;return a}(),ja=function(){function a(){}a.value=new a;return a}(),va=function(){function a(){}a.value=new a;return a}(),wa=function(){function a(){}a.value=new a;return a}(),C=function(){function a(){}a.value=new a;return a}(),ka=function(){function a(){}a.value=new a;return a}(),la=function(){function a(){}a.value=new a;return a}(),ma=function(){function a(){}
a.value=new a;return a}(),na=function(){function a(){}a.value=new a;return a}(),xa=function(){function a(){}a.value=new a;return a}(),ya=function(){function a(){}a.value=new a;return a}(),za=function(){function a(){}a.value=new a;return a}(),Aa=function(){function a(){}a.value=new a;return a}(),Ba=function(){function a(){}a.value=new a;return a}(),Ca=function(){function a(){}a.value=new a;return a}(),Da=function(){function a(){}a.value=new a;return a}(),T=function(){function a(){}a.value=new a;return a}(),
Ea=function(){function a(){}a.value=new a;return a}(),Fa=function(){function a(){}a.value=new a;return a}(),Ga=function(){function a(){}a.value=new a;return a}(),oa=function(){function a(){}a.value=new a;return a}(),Ha=function(){function a(){}a.value=new a;return a}(),Ra=function(){function a(){}a.value=new a;return a}(),Sa=function(){function a(){}a.value=new a;return a}(),Ta=function(){function a(){}a.value=new a;return a}(),Ua=function(){function a(){}a.value=new a;return a}(),Va=function(){function a(){}
a.value=new a;return a}(),Wa=function(){function a(){}a.value=new a;return a}(),Xa=function(){function a(){}a.value=new a;return a}(),Ya=function(){function a(){}a.value=new a;return a}(),Za=function(){function a(){}a.value=new a;return a}(),$a=function(){function a(){}a.value=new a;return a}(),ab=function(){function a(){}a.value=new a;return a}(),bb=function(){function a(){}a.value=new a;return a}(),cb=function(){function a(){}a.value=new a;return a}(),db=function(){function a(){}a.value=new a;return a}(),
eb=function(){function a(){}a.value=new a;return a}(),fb=function(){function a(){}a.value=new a;return a}(),gb=function(){function a(){}a.value=new a;return a}(),hb=function(){function a(){}a.value=new a;return a}(),ib=function(){function a(){}a.value=new a;return a}(),jb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),kb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),lb=function(){function a(){}a.value=new a;return a}(),
mb=function(){function a(){}a.value=new a;return a}(),nb=function(){function a(){}a.value=new a;return a}(),ob=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),pb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),qb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),rb=function(){function a(b){this.value0=b}
a.create=function(b){return new a(b)};return a}(),sb=function(){function a(){}a.value=new a;return a}(),tb=function(){function a(){}a.value=new a;return a}(),ub=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),vb=function(){function a(){}a.value=new a;return a}(),wb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),xb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),yb=function(){function a(){}
a.value=new a;return a}(),zb=function(){function a(){}a.value=new a;return a}(),Ab=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),Bb=function(){function a(){}a.value=new a;return a}(),Cb=function(){function a(){}a.value=new a;return a}(),Db=function(){function a(){}a.value=new a;return a}(),Eb=function(){function a(){}a.value=new a;return a}(),Fb=function(){function a(){}a.value=new a;return a}(),Gb=function(){function a(){}
a.value=new a;return a}(),pa=function(){function a(){}a.value=new a;return a}(),qa=function(){function a(){}a.value=new a;return a}(),ra=function(){function a(){}a.value=new a;return a}(),sa=function(){function a(){}a.value=new a;return a}(),ta=function(){function a(){}a.value=new a;return a}(),Hb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ib=function(){function a(){}a.value=new a;return a}(),Jb=function(){function a(){}a.value=new a;return a}(),Kb=function(){function a(){}
a.value=new a;return a}(),Lb=function(){function a(){}a.value=new a;return a}(),Mb=function(){function a(){}a.value=new a;return a}(),Nb=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ob=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Pb=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),Qb=function(){function a(b,
c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),Rb=function(){function a(b,c,d,e){this.value0=b;this.value1=c;this.value2=d;this.value3=e}a.create=function(b){return function(c){return function(d){return function(e){return new a(b,c,d,e)}}}};return a}(),Sb=function(){function a(){}a.value=new a;return a}(),Tb=function(){function a(){}a.value=new a;return a}(),Ub=function(){function a(){}a.value=new a;return a}(),Vb=function(){function a(){}a.value=
new a;return a}(),Wb=function(){function a(){}a.value=new a;return a}(),Xb=function(){function a(){}a.value=new a;return a}(),Yb=function(){function a(){}a.value=new a;return a}(),Zb=function(){function a(){}a.value=new a;return a}(),$b=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ac=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),Ia=function(){function a(){}a.value=new a;return a}(),
Ja=function(){function a(){}a.value=new a;return a}(),Ka=function(){function a(){}a.value=new a;return a}(),La=function(){function a(){}a.value=new a;return a}(),Ma=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Na=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Oa=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Pa=function(){function a(){}a.value=new a;return a}(),bc=function(){function a(b,
c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),cc=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),dc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ec=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),fc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
gc=function(){function a(b,c,d,e){this.value0=b;this.value1=c;this.value2=d;this.value3=e}a.create=function(b){return function(c){return function(d){return function(e){return new a(b,c,d,e)}}}};return a}(),hc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ic=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),jc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),kc=function(){function a(b){this.value0=
b}a.create=function(b){return new a(b)};return a}(),lc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),mc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),nc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),oc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),pc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
qc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),rc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),sc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),tc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),uc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),vc=function(){function a(b){this.value0=b}
a.create=function(b){return new a(b)};return a}(),wc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),xc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),yc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),zc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ac=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
Bc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Cc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Dc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ec=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Fc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Gc=function(){function a(b){this.value0=b}
a.create=function(b){return new a(b)};return a}(),Hc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ic=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Jc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Kc=function(){function a(){}a.value=new a;return a}(),Lc=function(){function a(){}a.value=new a;return a}(),Mc=function(){function a(){}a.value=new a;return a}(),Nc=function(){function a(){}
a.value=new a;return a}(),Oc=function(){function a(){}a.value=new a;return a}(),Pc=function(){function a(){}a.value=new a;return a}(),Qc=function(){function a(){}a.value=new a;return a}(),Rc=function(){function a(){}a.value=new a;return a}(),Sc=function(){function a(){}a.value=new a;return a}(),Tc=function(){function a(){}a.value=new a;return a}(),Uc=function(){function a(){}a.value=new a;return a}(),Vc=function(){function a(){}a.value=new a;return a}(),Wc=function(){function a(){}a.value=new a;return a}(),
Xc=function(){function a(){}a.value=new a;return a}(),Yc=function(){function a(){}a.value=new a;return a}(),Zc=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),$c=function(){function a(){}a.value=new a;return a}(),ad=function(){function a(){}a.value=new a;return a}(),bd=function(){function a(){}a.value=new a;return a}(),cd=function(){function a(){}a.value=new a;return a}(),dd=function(){function a(){}a.value=new a;return a}(),ed=function(){function a(){}a.value=
new a;return a}(),fd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),gd=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),hd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),id=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,
c,d)}}};return a}(),jd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),kd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ld=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),md=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),nd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),od=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),pd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),qd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),rd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),sd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),td=function(){function a(b){this.value0=
b}a.create=function(b){return new a(b)};return a}(),ud=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),vd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),wd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),xd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),yd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),zd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ad=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Bd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),Cd=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,
c)}};return a}(),Dd=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Ed=new a.Show(function(a){if(a instanceof pa)return"Points";if(a instanceof qa)return"Lines";if(a instanceof ra)return"Triangles";if(a instanceof sa)return"LinesAdjacency";if(a instanceof ta)return"TrianglesAdjacency";throw Error("Failed pattern match");}),ua=new a.Show(function(a){if(a instanceof Ia)return"Red";if(a instanceof Ja)return"RG";if(a instanceof Ka)return"RGB";if(a instanceof La)return"RGBA";
throw Error("Failed pattern match");}),Fd=new a.Show(function(b){if(b instanceof Ma)return"FloatT "+a.show(ua)(b.value0);if(b instanceof Na)return"IntT "+a.show(ua)(b.value0);if(b instanceof Oa)return"WordT "+a.show(ua)(b.value0);if(b instanceof Pa)return"ShadowT";throw Error("Failed pattern match");}),Qa=new a.Eq(function(b){return function(c){return!a["=="](Qa)(b)(c)}},function(a){return function(b){if(a instanceof pa&&b instanceof pa||a instanceof qa&&b instanceof qa||a instanceof ra&&b instanceof
ra||a instanceof sa&&b instanceof sa||a instanceof ta&&b instanceof ta)return!0;throw Error("Failed pattern match");}});return{Pipeline:Dd,RenderTarget:rb,TargetItem:qb,StreamData:od,Slot:Hb,Program:kb,Parameter:jb,SamplerDescriptor:Ic,TextureDescriptor:Jc,SetRasterContext:qd,SetAccumulationContext:rd,SetRenderTarget:sd,SetProgram:td,SetSamplerUniform:ud,SetTexture:vd,SetSampler:wd,RenderSlot:xd,RenderStream:yd,ClearRenderTarget:zd,GenerateMipMap:Ad,SaveImage:Bd,LoadImage:Cd,ClearImage:Hc,Depth:lb,
Stencil:mb,Color:nb,TextureImage:ob,Framebuffer:pb,Repeat:Ib,MirroredRepeat:Jb,ClampToEdge:Kb,ClampToBorder:Lb,Nearest:Bb,Linear:Cb,NearestMipmapNearest:Db,NearestMipmapLinear:Eb,LinearMipmapNearest:Fb,LinearMipmapLinear:Gb,Texture1D:bc,Texture2D:cc,Texture3D:dc,TextureCube:ec,TextureRect:fc,Texture2DMS:gc,TextureBuffer:hc,FloatT:Ma,IntT:Na,WordT:Oa,ShadowT:Pa,AccumulationContext:pd,DepthOp:hd,StencilOp:id,ColorOp:jd,PointCtx:Pb,LineCtx:Qb,TriangleCtx:Rb,NoBlending:ed,BlendLogicOp:fd,Blend:gd,BlendingFactorPair:Zc,
Red:Ia,RG:Ja,RGB:Ka,RGBA:La,Points:pa,Lines:qa,Triangles:ra,LinesAdjacency:sa,TrianglesAdjacency:ta,StencilTest:$b,StencilTests:ac,StencilOps:r,Clear:x,And:E,AndReverse:m,Copy:u,AndInverted:B,Noop:p,Xor:F,Or:I,Nor:v,Equiv:L,Invert:M,OrReverse:H,CopyInverted:G,OrInverted:D,Nand:y,Set:z,Zero:Kc,One:Lc,SrcColor:Mc,OneMinusSrcColor:Nc,DstColor:Oc,OneMinusDstColor:Pc,SrcAlpha:Qc,OneMinusSrcAlpha:Rc,DstAlpha:Sc,OneMinusDstAlpha:Tc,ConstantColor:Uc,OneMinusConstantColor:Vc,ConstantAlpha:Wc,OneMinusConstantAlpha:Xc,
SrcAlphaSaturate:Yc,FuncAdd:$c,FuncSubtract:ad,FuncReverseSubtract:bd,Min:cd,Max:dd,OpZero:d,OpKeep:h,OpReplace:f,OpIncr:g,OpIncrWrap:n,OpDecr:t,OpDecrWrap:k,OpInvert:q,Never:Sb,Less:Tb,Equal:Ub,Lequal:Vb,Greater:Wb,Notequal:Xb,Gequal:Yb,Always:Zb,CullNone:Mb,CullFront:Nb,CullBack:Ob,FirstVertex:A,LastVertex:l,PolygonPoint:wb,PolygonLine:xb,PolygonFill:yb,CCW:sb,CW:tb,NoOffset:zb,Offset:Ab,PointSize:ub,ProgramPointSize:vb,LowerLeft:w,UpperLeft:K,Bool:J,V2B:P,V3B:Q,V4B:O,Word:R,V2U:U,V3U:S,V4U:N,Int:V,
V2I:Z,V3I:aa,V4I:W,Float:X,V2F:Y,V3F:ba,V4F:ca,M22F:da,M23F:ea,M24F:fa,M32F:ga,M33F:ha,M34F:ja,M42F:va,M43F:wa,M44F:C,STexture1D:ka,STexture2D:la,STextureCube:ma,STexture1DArray:na,STexture2DArray:xa,STexture2DRect:ya,FTexture1D:za,FTexture2D:Aa,FTexture3D:Ba,FTextureCube:Ca,FTexture1DArray:Da,FTexture2DArray:T,FTexture2DMS:Ea,FTexture2DMSArray:Fa,FTextureBuffer:Ga,FTexture2DRect:oa,ITexture1D:Ha,ITexture2D:Ra,ITexture3D:Sa,ITextureCube:Ta,ITexture1DArray:Ua,ITexture2DArray:Va,ITexture2DMS:Wa,ITexture2DMSArray:Xa,
ITextureBuffer:Ya,ITexture2DRect:Za,UTexture1D:$a,UTexture2D:ab,UTexture3D:bb,UTextureCube:cb,UTexture1DArray:db,UTexture2DArray:eb,UTexture2DMS:fb,UTexture2DMSArray:gb,UTextureBuffer:hb,UTexture2DRect:ib,VBool:ic,VV2B:jc,VV3B:kc,VV4B:lc,VWord:mc,VV2U:nc,VV3U:oc,VV4U:pc,VInt:qc,VV2I:rc,VV3I:sc,VV4I:tc,VFloat:uc,VV2F:vc,VV3F:wc,VV4F:xc,VM22F:yc,VM23F:zc,VM24F:Ac,VM32F:Bc,VM33F:Cc,VM34F:Dc,VM42F:Ec,VM43F:Fc,VM44F:Gc,VBoolArray:kd,VIntArray:ld,VWordArray:md,VFloatArray:nd,V4:b,V3:e,V2:c,eqFetchPrimitive:Qa,
showFetchPrimitive:Ed,showColorArity:ua,showTextureDataType:Fd}}();PS=PS||{};
PS.Data_Argonaut_Core=function(){function a(a,b,c,d,e,h,r){return null==r?a(null):"boolean"===typeof r?b(r):"number"===typeof r?c(r):"string"===typeof r?d(r):"[object Array]"===Object.prototype.toString.call(r)?e(r):h(r)}var b=PS.Prelude,e=PS.Data_Maybe,c=function(a){return function(b){return function(c){return c(a)(b)}}}(e.Nothing.value)(e.Just.create),e=function(c){return function(d){return function(e){return a(b["const"](c),b["const"](c),b["const"](c),b["const"](c),b["const"](c),d,e)}}},d=c(e),
h=function(c){return function(d){return function(e){return a(b["const"](c),b["const"](c),b["const"](c),b["const"](c),d,b["const"](c),e)}}},c=c(h);return{toObject:d,toArray:c,foldJsonString:function(c){return function(d){return function(e){return a(b["const"](c),b["const"](c),b["const"](c),d,b["const"](c),b["const"](c),e)}}},foldJsonObject:e,foldJsonNumber:function(c){return function(d){return function(e){return a(b["const"](c),b["const"](c),d,b["const"](c),b["const"](c),b["const"](c),e)}}},foldJsonBoolean:function(c){return function(d){return function(e){return a(b["const"](c),
d,b["const"](c),b["const"](c),b["const"](c),b["const"](c),e)}}},foldJsonArray:h}}();PS=PS||{};PS.Data_Argonaut_Parser=function(){var a=PS.Data_Either;return{jsonParser:function(b){var e;var c=a.Left.create;try{e=(0,a.Right.create)(JSON.parse(b))}catch(d){e=c(d.message)}return e}}}();PS=PS||{};
PS.Data_Argonaut_Decode=function(){var a=PS.Control_Alt,b=PS.Prelude,e=PS.Data_Argonaut_Core,c=PS.Data_Maybe,d=PS.Data_Traversable,h=PS.Data_Either,f=PS.Data_StrMap,g=function(a){this.decodeJson=a},n=new g(e.foldJsonString(new h.Left("Not a String."))(h.Right.create)),t=new g(e.foldJsonNumber(new h.Left("Not a Number."))(h.Right.create)),k=new g(h.Right.create),q=new g(e.foldJsonBoolean(new h.Left("Not a Boolean."))(h.Right.create)),r=function(a){return function(d){return h.either(b["const"](c.Nothing.value))(c.Just.create)((0,a.decodeJson)(d))}};
return{DecodeJson:g,decodeMaybe:r,decodeJson:function(a){return a.decodeJson},decodeJsonMaybe:function(d){return new g(function(e){return a["<|>"](h.altEither)(b["<$>"](h.functorEither)(c.Just.create)((0,d.decodeJson)(e)))(b.pure(h.applicativeEither)(c.Nothing.value))})},decodeJsonBoolean:q,decodeJsonNumber:t,decodeJsonString:n,decodeJsonJson:k,decodeStrMap:function(a){return new g(function(g){return c.maybe(new h.Left("Couldn't decode."))(h.Right.create)(b[">>="](c.bindMaybe)(e.toObject(g))(function(b){return d.traverse(f.traversableStrMap)(c.applicativeMaybe)(r(a))(b)}))})},
decodeArray:function(a){return new g(function(f){return c.maybe(new h.Left("Couldn't decode."))(h.Right.create)(b[">>="](c.bindMaybe)(e.toArray(f))(function(b){return d.traverse(d.traversableArray)(c.applicativeMaybe)(r(a))(b)}))})}}}();PS=PS||{};PS.Data_Argonaut_Combinators=function(){var a=PS.Prelude,b=PS.Data_StrMap,e=PS.Data_Maybe,c=PS.Data_Argonaut_Decode,d=PS.Data_Either;return{".?":function(h){return function(f){return function(g){return e.maybe(d.Left.create("Expected field "+a.show(a.showString)(g)))(c.decodeJson(h))(b.lookup(g)(f))}}}}}();
PS=PS||{};PS.Data_Argonaut=function(){return{jsonParser:PS.Data_Argonaut_Parser.jsonParser,decodeJson:PS.Data_Argonaut_Decode.decodeJson,".?":PS.Data_Argonaut_Combinators[".?"]}}();PS=PS||{};
PS.PipelineJsonDecode=function(){var a=PS.Prelude,b=PS.Data_Argonaut_Decode,e=PS.Data_Argonaut,c=PS.IR,d=PS.Data_Either,h=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),f=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),g=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),n=function(f){return new b.DecodeJson(function(v){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(v))(function(b){return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.V4.create)(e[".?"](f)(b)("x")))(e[".?"](f)(b)("y")))(e[".?"](f)(b)("z")))(e[".?"](f)(b)("w"))})})},
t=function(f){return new b.DecodeJson(function(v){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(v))(function(b){return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.V3.create)(e[".?"](f)(b)("x")))(e[".?"](f)(b)("y")))(e[".?"](f)(b)("z"))})})},k=function(f){return new b.DecodeJson(function(v){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(v))(function(b){return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.V2.create)(e[".?"](f)(b)("x")))(e[".?"](f)(b)("y"))})})},
q=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(C){if("VBool"===C)return a["<$>"](d.functorEither)(c.VBool.create)(e[".?"](b.decodeJsonBoolean)(f)("value"));if("VV2B"===C)return a["<$>"](d.functorEither)(c.VV2B.create)(e[".?"](k(b.decodeJsonBoolean))(f)("value"));if("VV3B"===C)return a["<$>"](d.functorEither)(c.VV3B.create)(e[".?"](t(b.decodeJsonBoolean))(f)("value"));
if("VV4B"===C)return a["<$>"](d.functorEither)(c.VV4B.create)(e[".?"](n(b.decodeJsonBoolean))(f)("value"));if("VWord"===C)return a["<$>"](d.functorEither)(c.VWord.create)(e[".?"](b.decodeJsonNumber)(f)("value"));if("VV2U"===C)return a["<$>"](d.functorEither)(c.VV2U.create)(e[".?"](k(b.decodeJsonNumber))(f)("value"));if("VV3U"===C)return a["<$>"](d.functorEither)(c.VV3U.create)(e[".?"](t(b.decodeJsonNumber))(f)("value"));if("VV4U"===C)return a["<$>"](d.functorEither)(c.VV4U.create)(e[".?"](n(b.decodeJsonNumber))(f)("value"));
if("VInt"===C)return a["<$>"](d.functorEither)(c.VInt.create)(e[".?"](b.decodeJsonNumber)(f)("value"));if("VV2I"===C)return a["<$>"](d.functorEither)(c.VV2I.create)(e[".?"](k(b.decodeJsonNumber))(f)("value"));if("VV3I"===C)return a["<$>"](d.functorEither)(c.VV3I.create)(e[".?"](t(b.decodeJsonNumber))(f)("value"));if("VV4I"===C)return a["<$>"](d.functorEither)(c.VV4I.create)(e[".?"](n(b.decodeJsonNumber))(f)("value"));if("VFloat"===C)return a["<$>"](d.functorEither)(c.VFloat.create)(e[".?"](b.decodeJsonNumber)(f)("value"));
if("VV2F"===C)return a["<$>"](d.functorEither)(c.VV2F.create)(e[".?"](k(b.decodeJsonNumber))(f)("value"));if("VV3F"===C)return a["<$>"](d.functorEither)(c.VV3F.create)(e[".?"](t(b.decodeJsonNumber))(f)("value"));if("VV4F"===C)return a["<$>"](d.functorEither)(c.VV4F.create)(e[".?"](n(b.decodeJsonNumber))(f)("value"));if("VM22F"===C)return a["<$>"](d.functorEither)(c.VM22F.create)(e[".?"](k(k(b.decodeJsonNumber)))(f)("value"));if("VM23F"===C)return a["<$>"](d.functorEither)(c.VM23F.create)(e[".?"](t(k(b.decodeJsonNumber)))(f)("value"));
if("VM24F"===C)return a["<$>"](d.functorEither)(c.VM24F.create)(e[".?"](n(k(b.decodeJsonNumber)))(f)("value"));if("VM32F"===C)return a["<$>"](d.functorEither)(c.VM32F.create)(e[".?"](k(t(b.decodeJsonNumber)))(f)("value"));if("VM33F"===C)return a["<$>"](d.functorEither)(c.VM33F.create)(e[".?"](t(t(b.decodeJsonNumber)))(f)("value"));if("VM34F"===C)return a["<$>"](d.functorEither)(c.VM34F.create)(e[".?"](n(t(b.decodeJsonNumber)))(f)("value"));if("VM42F"===C)return a["<$>"](d.functorEither)(c.VM42F.create)(e[".?"](k(n(b.decodeJsonNumber)))(f)("value"));
if("VM43F"===C)return a["<$>"](d.functorEither)(c.VM43F.create)(e[".?"](t(n(b.decodeJsonNumber)))(f)("value"));if("VM44F"===C)return a["<$>"](d.functorEither)(c.VM44F.create)(e[".?"](n(n(b.decodeJsonNumber)))(f)("value"));throw Error("Failed pattern match");})})}),r=new b.DecodeJson(function(c){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(c))(function(c){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(c)("startL"))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(c)("startC"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(c)("endL"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(c)("endC"))(function(z){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(c)("text"))(function(b){return a["return"](d.monadEither)(new h({startLine:f,
startColumn:v,endLine:g,endColumn:z,text:b}))})})})})})})}),A=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("OpZero"===b)return c.OpZero.value;if("OpKeep"===b)return c.OpKeep.value;if("OpReplace"===b)return c.OpReplace.value;if("OpIncr"===b)return c.OpIncr.value;if("OpIncrWrap"===b)return c.OpIncrWrap.value;
if("OpDecr"===b)return c.OpDecr.value;if("OpDecrWrap"===b)return c.OpDecrWrap.value;if("OpInvert"===b)return c.OpInvert.value;throw Error("Failed pattern match");}())})})}),l=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(b){return a[">>="](d.bindEither)(e[".?"](A)(b)("frontStencilOp"))(function(f){return a[">>="](d.bindEither)(e[".?"](A)(b)("backStencilOp"))(function(b){return a.pure(d.applicativeEither)(new c.StencilOps({frontStencilOp:f,
backStencilOp:b}))})})})}),w=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){var e=a["return"](d.monadEither);if("FirstVertex"===b)b=c.FirstVertex.value;else if("LastVertex"===b)b=c.LastVertex.value;else throw Error("Failed pattern match");return e(b)})})}),K=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(C){if("Offset"===
C)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.Offset.create)(e[".?"](b.decodeJsonNumber)(f)("factor")))(e[".?"](b.decodeJsonNumber)(f)("units"));if("NoOffset"===C)return a.pure(d.applicativeEither)(c.NoOffset.value);throw Error("Failed pattern match");})})}),x=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){var e=a["return"](d.monadEither);
if("LowerLeft"===b)b=c.LowerLeft.value;else if("UpperLeft"===b)b=c.UpperLeft.value;else throw Error("Failed pattern match");return e(b)})})}),E=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(C){if("PointSize"===C)return a["<$>"](d.functorEither)(c.PointSize.create)(e[".?"](b.decodeJsonNumber)(f)("size"));if("ProgramPointSize"===C)return a.pure(d.applicativeEither)(c.ProgramPointSize.value);
throw Error("Failed pattern match");})})}),m=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(C){if("PolygonPoint"===C)return a["<$>"](d.functorEither)(c.PolygonPoint.create)(e[".?"](E)(f)("size"));if("PolygonLine"===C)return a["<$>"](d.functorEither)(c.PolygonLine.create)(e[".?"](b.decodeJsonNumber)(f)("size"));if("PolygonFill"===C)return a.pure(d.applicativeEither)(c.PolygonFill.value);
throw Error("Failed pattern match");})})}),u=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Clear"===b)return c.Clear.value;if("And"===b)return c.And.value;if("AndReverse"===b)return c.AndReverse.value;if("Copy"===b)return c.Copy.value;if("AndInverted"===b)return c.AndInverted.value;if("Noop"===
b)return c.Noop.value;if("Xor"===b)return c.Xor.value;if("Or"===b)return c.Or.value;if("Nor"===b)return c.Nor.value;if("Equiv"===b)return c.Equiv.value;if("Invert"===b)return c.Invert.value;if("OrReverse"===b)return c.OrReverse.value;if("CopyInverted"===b)return c.CopyInverted.value;if("OrInverted"===b)return c.OrInverted.value;if("Nand"===b)return c.Nand.value;if("Set"===b)return c.Set.value;throw Error("Failed pattern match");}())})})}),B=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Bool"===
b)return c.Bool.value;if("V2B"===b)return c.V2B.value;if("V3B"===b)return c.V3B.value;if("V4B"===b)return c.V4B.value;if("Word"===b)return c.Word.value;if("V2U"===b)return c.V2U.value;if("V3U"===b)return c.V3U.value;if("V4U"===b)return c.V4U.value;if("Int"===b)return c.Int.value;if("V2I"===b)return c.V2I.value;if("V3I"===b)return c.V3I.value;if("V4I"===b)return c.V4I.value;if("Float"===b)return c.Float.value;if("V2F"===b)return c.V2F.value;if("V3F"===b)return c.V3F.value;if("V4F"===b)return c.V4F.value;
if("M22F"===b)return c.M22F.value;if("M23F"===b)return c.M23F.value;if("M24F"===b)return c.M24F.value;if("M32F"===b)return c.M32F.value;if("M33F"===b)return c.M33F.value;if("M34F"===b)return c.M34F.value;if("M42F"===b)return c.M42F.value;if("M43F"===b)return c.M43F.value;if("M44F"===b)return c.M44F.value;if("STexture1D"===b)return c.STexture1D.value;if("STexture2D"===b)return c.STexture2D.value;if("STextureCube"===b)return c.STextureCube.value;if("STexture1DArray"===b)return c.STexture1DArray.value;
if("STexture2DArray"===b)return c.STexture2DArray.value;if("STexture2DRect"===b)return c.STexture2DRect.value;if("FTexture1D"===b)return c.FTexture1D.value;if("FTexture2D"===b)return c.FTexture2D.value;if("FTexture3D"===b)return c.FTexture3D.value;if("FTextureCube"===b)return c.FTextureCube.value;if("FTexture1DArray"===b)return c.FTexture1DArray.value;if("FTexture2DArray"===b)return c.FTexture2DArray.value;if("FTexture2DMS"===b)return c.FTexture2DMS.value;if("FTexture2DMSArray"===b)return c.FTexture2DMSArray.value;
if("FTextureBuffer"===b)return c.FTextureBuffer.value;if("FTexture2DRect"===b)return c.FTexture2DRect.value;if("ITexture1D"===b)return c.ITexture1D.value;if("ITexture2D"===b)return c.ITexture2D.value;if("ITexture3D"===b)return c.ITexture3D.value;if("ITextureCube"===b)return c.ITextureCube.value;if("ITexture1DArray"===b)return c.ITexture1DArray.value;if("ITexture2DArray"===b)return c.ITexture2DArray.value;if("ITexture2DMS"===b)return c.ITexture2DMS.value;if("ITexture2DMSArray"===b)return c.ITexture2DMSArray.value;
if("ITextureBuffer"===b)return c.ITextureBuffer.value;if("ITexture2DRect"===b)return c.ITexture2DRect.value;if("UTexture1D"===b)return c.UTexture1D.value;if("UTexture2D"===b)return c.UTexture2D.value;if("UTexture3D"===b)return c.UTexture3D.value;if("UTextureCube"===b)return c.UTextureCube.value;if("UTexture1DArray"===b)return c.UTexture1DArray.value;if("UTexture2DArray"===b)return c.UTexture2DArray.value;if("UTexture2DMS"===b)return c.UTexture2DMS.value;if("UTexture2DMSArray"===b)return c.UTexture2DMSArray.value;
if("UTextureBuffer"===b)return c.UTextureBuffer.value;if("UTexture2DRect"===b)return c.UTexture2DRect.value;throw Error("Failed pattern match");}())})})}),p=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("name"))(function(b){return a[">>="](d.bindEither)(e[".?"](B)(f)("ty"))(function(e){return a.pure(d.applicativeEither)(new c.Parameter({name:b,ty:e}))})})})}),F=
new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(B))(f)("programUniforms"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(p))(f)("programStreams"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(B))(f)("programInTextures"))(function(z){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(p))(f)("programOutput"))(function(h){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("vertexShader"))(function(J){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(b.decodeJsonString))(f)("geometryShader"))(function(k){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("fragmentShader"))(function(b){return a.pure(d.applicativeEither)(new c.Program({programUniforms:v,
programStreams:g,programInTextures:z,programOutput:h,vertexShader:J,geometryShader:k,fragmentShader:b}))})})})})})})})})}),I=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Depth"===b)return c.Depth.value;if("Stencil"===b)return c.Stencil.value;if("Color"===b)return c.Color.value;throw Error("Failed pattern match");
}())})})}),v=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("TextureImage"===v)return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.TextureImage.create)(e[".?"](b.decodeJsonNumber)(f)("tex")))(e[".?"](b.decodeJsonNumber)(f)("mip")))(e[".?"](b.decodeJsonMaybe(b.decodeJsonNumber))(f)("layer"));if("Framebuffer"===
v)return a["<$>"](d.functorEither)(c.Framebuffer.create)(e[".?"](I)(f)("semantic"));throw Error("Failed pattern match");})})}),L=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](I)(f)("semantic"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(v))(f)("ref"))(function(b){return a.pure(d.applicativeEither)(new c.TargetItem({semantic:g,ref:b}))})})})}),M=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(L))(f)("renderTargets"))(function(b){return a.pure(d.applicativeEither)(new c.RenderTarget({renderTargets:b}))})})}),
H=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){var e=a["return"](d.monadEither);if("CCW"===b)b=c.CCW.value;else if("CW"===b)b=c.CW.value;else throw Error("Failed pattern match");return e(b)})})}),G=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Nearest"===
b)return c.Nearest.value;if("Linear"===b)return c.Linear.value;if("NearestMipmapNearest"===b)return c.NearestMipmapNearest.value;if("NearestMipmapLinear"===b)return c.NearestMipmapLinear.value;if("LinearMipmapNearest"===b)return c.LinearMipmapNearest.value;if("LinearMipmapLinear"===b)return c.LinearMipmapLinear.value;throw Error("Failed pattern match");}())})})}),D=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Points"===
b)return c.Points.value;if("Lines"===b)return c.Lines.value;if("Triangles"===b)return c.Triangles.value;if("LinesAdjacency"===b)return c.LinesAdjacency.value;if("TrianglesAdjacency"===b)return c.TrianglesAdjacency.value;throw Error("Failed pattern match");}())})})}),y=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("slotName"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(B))(f)("slotUniforms"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(B))(f)("slotStreams"))(function(z){return a[">>="](d.bindEither)(e[".?"](D)(f)("slotPrimitive"))(function(h){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(b.decodeJsonNumber))(f)("slotPrograms"))(function(b){return a.pure(d.applicativeEither)(new c.Slot({slotName:v,
slotUniforms:g,slotStreams:z,slotPrimitive:h,slotPrograms:b}))})})})})})})}),z=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Repeat"===b)return c.Repeat.value;if("MirroredRepeat"===b)return c.MirroredRepeat.value;if("ClampToEdge"===b)return c.ClampToEdge.value;if("ClampToBorder"===b)return c.ClampToBorder.value;
throw Error("Failed pattern match");}())})})}),J=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){if("CullFront"===b)return a["<$>"](d.functorEither)(c.CullFront.create)(e[".?"](H)(f)("face"));if("CullBack"===b)return a["<$>"](d.functorEither)(c.CullBack.create)(e[".?"](H)(f)("face"));if("CullNone"===b)return a.pure(d.applicativeEither)(c.CullNone.value);
throw Error("Failed pattern match");})})}),P=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("PointCtx"===v)return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.PointCtx.create)(e[".?"](E)(f)("size")))(e[".?"](b.decodeJsonNumber)(f)("threshold")))(e[".?"](x)(f)("origin"));if("LineCtx"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.LineCtx.create)(e[".?"](b.decodeJsonNumber)(f)("size")))(e[".?"](w)(f)("provokingVertex"));
if("TriangleCtx"===v)return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.TriangleCtx.create)(e[".?"](J)(f)("cullMode")))(e[".?"](m)(f)("polygonMode")))(e[".?"](K)(f)("polygonOffset")))(e[".?"](w)(f)("provokingVertex"));throw Error("Failed pattern match");})})}),Q=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Never"===
b)return c.Never.value;if("Less"===b)return c.Less.value;if("Equal"===b)return c.Equal.value;if("Lequal"===b)return c.Lequal.value;if("Greater"===b)return c.Greater.value;if("Notequal"===b)return c.Notequal.value;if("Gequal"===b)return c.Gequal.value;if("Always"===b)return c.Always.value;throw Error("Failed pattern match");}())})})}),O=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](z)(f)("samplerWrapS"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(z))(f)("samplerWrapT"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(z))(f)("samplerWrapR"))(function(z){return a[">>="](d.bindEither)(e[".?"](G)(f)("samplerMinFilter"))(function(h){return a[">>="](d.bindEither)(e[".?"](G)(f)("samplerMagFilter"))(function(J){return a[">>="](d.bindEither)(e[".?"](q)(f)("samplerBorderColor"))(function(k){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(b.decodeJsonNumber))(f)("samplerMinLod"))(function(P){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(b.decodeJsonNumber))(f)("samplerMaxLod"))(function(L){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(f)("samplerLodBias"))(function(p){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(Q))(f)("samplerCompareFunc"))(function(b){return a.pure(d.applicativeEither)(new c.SamplerDescriptor({samplerWrapS:v,
samplerWrapT:g,samplerWrapR:z,samplerMinFilter:h,samplerMagFilter:J,samplerBorderColor:k,samplerMinLod:P,samplerMaxLod:L,samplerLodBias:p,samplerCompareFunc:b}))})})})})})})})})})})})}),R=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](Q)(f)("stencilComparision"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(f)("stencilReference"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(f)("stencilMask"))(function(b){return a.pure(d.applicativeEither)(new c.StencilTest({stencilComparision:v,
stencilReference:g,stencilMask:b}))})})})})}),U=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(b){return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.StencilTests.create)(e[".?"](R)(b)("front")))(e[".?"](R)(b)("back"))})}),S=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Red"===
b)return c.Red.value;if("RG"===b)return c.RG.value;if("RGB"===b)return c.RGB.value;if("RGBA"===b)return c.RGBA.value;throw Error("Failed pattern match");}())})})}),N=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){if("FloatT"===b)return a["<$>"](d.functorEither)(c.FloatT.create)(e[".?"](S)(f)("arity"));if("IntT"===b)return a["<$>"](d.functorEither)(c.IntT.create)(e[".?"](S)(f)("arity"));
if("WordT"===b)return a["<$>"](d.functorEither)(c.WordT.create)(e[".?"](S)(f)("arity"));if("ShadowT"===b)return a.pure(d.applicativeEither)(c.ShadowT.value);throw Error("Failed pattern match");})})}),V=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("Texture1D"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.Texture1D.create)(e[".?"](N)(f)("texType")))(e[".?"](b.decodeJsonNumber)(f)("layers"));
if("Texture2D"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.Texture2D.create)(e[".?"](N)(f)("texType")))(e[".?"](b.decodeJsonNumber)(f)("layers"));if("Texture3D"===v)return a["<$>"](d.functorEither)(c.Texture3D.create)(e[".?"](N)(f)("texType"));if("TextureCube"===v)return a["<$>"](d.functorEither)(c.TextureCube.create)(e[".?"](N)(f)("texType"));if("TextureRect"===v)return a["<$>"](d.functorEither)(c.TextureRect.create)(e[".?"](N)(f)("texType"));if("Texture2DMS"===v)return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.Texture2DMS.create)(e[".?"](N)(f)("texType")))(e[".?"](b.decodeJsonNumber)(f)("layers")))(e[".?"](b.decodeJsonNumber)(f)("param1")))(e[".?"](b.decodeJsonBoolean)(f)("param2"));
if("TextureBuffer"===v)return a["<$>"](d.functorEither)(c.TextureBuffer.create)(e[".?"](N)(f)("texType"));throw Error("Failed pattern match");})})}),Z=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](V)(f)("textureType"))(function(v){return a[">>="](d.bindEither)(e[".?"](q)(f)("textureSize"))(function(g){return a[">>="](d.bindEither)(e[".?"](I)(f)("textureSemantic"))(function(z){return a[">>="](d.bindEither)(e[".?"](O)(f)("textureSampler"))(function(h){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(f)("textureBaseLevel"))(function(J){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonNumber)(f)("textureMaxLevel"))(function(b){return a.pure(d.applicativeEither)(new c.TextureDescriptor({textureType:v,
textureSize:g,textureSemantic:z,textureSampler:h,textureBaseLevel:J,textureMaxLevel:b}))})})})})})})})}),aa=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(b){return a[">>="](d.bindEither)(e[".?"](I)(b)("semantic"))(function(f){return a[">>="](d.bindEither)(e[".?"](q)(b)("value"))(function(b){return a.pure(d.applicativeEither)(new c.ClearImage({semantic:f,value:b}))})})})}),W=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("Zero"===
b)return c.Zero.value;if("One"===b)return c.One.value;if("SrcColor"===b)return c.SrcColor.value;if("OneMinusSrcColor"===b)return c.OneMinusSrcColor.value;if("DstColor"===b)return c.DstColor.value;if("OneMinusDstColor"===b)return c.OneMinusDstColor.value;if("SrcAlpha"===b)return c.SrcAlpha.value;if("OneMinusSrcAlpha"===b)return c.OneMinusSrcAlpha.value;if("DstAlpha"===b)return c.DstAlpha.value;if("OneMinusDstAlpha"===b)return c.OneMinusDstAlpha.value;if("ConstantColor"===b)return c.ConstantColor.value;
if("OneMinusConstantColor"===b)return c.OneMinusConstantColor.value;if("ConstantAlpha"===b)return c.ConstantAlpha.value;if("OneMinusConstantAlpha"===b)return c.OneMinusConstantAlpha.value;if("SrcAlphaSaturate"===b)return c.SrcAlphaSaturate.value;throw Error("Failed pattern match");}())})})}),X=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(b){return a[">>="](d.bindEither)(e[".?"](W)(b)("src"))(function(f){return a[">>="](d.bindEither)(e[".?"](W)(b)("dst"))(function(b){return a.pure(d.applicativeEither)(new c.BlendingFactorPair({src:f,
dst:b}))})})})}),Y=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(b){return a["return"](d.monadEither)(function(){if("FuncAdd"===b)return c.FuncAdd.value;if("FuncSubtract"===b)return c.FuncSubtract.value;if("FuncReverseSubtract"===b)return c.FuncReverseSubtract.value;if("Min"===b)return c.Min.value;if("Max"===b)return c.Max.value;throw Error("Failed pattern match");
}())})})}),ba=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("NoBlending"===v)return a.pure(d.applicativeEither)(c.NoBlending.value);if("BlendLogicOp"===v)return a["<$>"](d.functorEither)(c.BlendLogicOp.create)(e[".?"](u)(f)("op"));if("Blend"===v)return a[">>="](d.bindEither)(e[".?"](Y)(f)("colorEq"))(function(v){return a[">>="](d.bindEither)(e[".?"](Y)(f)("alphaEq"))(function(g){return a[">>="](d.bindEither)(e[".?"](X)(f)("colorF"))(function(z){return a[">>="](d.bindEither)(e[".?"](X)(f)("alphaF"))(function(h){return a["<$>"](d.functorEither)(c.Blend.create({colorEq:v,
alphaEq:g})({colorF:z,alphaF:h}))(e[".?"](n(b.decodeJsonNumber))(f)("color"))})})})});throw Error("Failed pattern match");})})}),ca=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("DepthOp"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.DepthOp.create)(e[".?"](Q)(f)("depthFunction")))(e[".?"](b.decodeJsonBoolean)(f)("depthMask"));
if("StencilOp"===v)return a["<*>"](d.applyEither)(a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.StencilOp.create)(e[".?"](U)(f)("stencilTests")))(e[".?"](l)(f)("front")))(e[".?"](l)(f)("back"));if("ColorOp"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.ColorOp.create)(e[".?"](ba)(f)("blend")))(e[".?"](q)(f)("mask"));throw Error("Failed pattern match");})})}),da=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(v){if("VBoolArray"===
v)return a["<$>"](d.functorEither)(c.VBoolArray.create)(e[".?"](b.decodeArray(b.decodeJsonBoolean))(f)("value"));if("VIntArray"===v)return a["<$>"](d.functorEither)(c.VIntArray.create)(e[".?"](b.decodeArray(b.decodeJsonNumber))(f)("value"));if("VWordArray"===v)return a["<$>"](d.functorEither)(c.VWordArray.create)(e[".?"](b.decodeArray(b.decodeJsonNumber))(f)("value"));if("VFloatArray"===v)return a["<$>"](d.functorEither)(c.VFloatArray.create)(e[".?"](b.decodeArray(b.decodeJsonNumber))(f)("value"));
throw Error("Failed pattern match");})})}),ea=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(da))(f)("streamData"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeStrMap(B))(f)("streamType"))(function(g){return a[">>="](d.bindEither)(e[".?"](D)(f)("streamPrimitive"))(function(z){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(b.decodeJsonNumber))(f)("streamPrograms"))(function(b){return a.pure(d.applicativeEither)(new c.StreamData({streamData:v,
streamType:g,streamPrimitive:z,streamPrograms:b}))})})})})})}),fa=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonMaybe(b.decodeJsonString))(f)("viewportName"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(ca))(f)("operations"))(function(b){return a.pure(d.applicativeEither)(new c.AccumulationContext({accViewportName:v,accOperations:b}))})})})}),ga=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(f)("tag"))(function(g){if("SetRasterContext"===
g)return a["<$>"](d.functorEither)(c.SetRasterContext.create)(e[".?"](P)(f)("context"));if("SetAccumulationContext"===g)return a["<$>"](d.functorEither)(c.SetAccumulationContext.create)(e[".?"](fa)(f)("context"));if("SetRenderTarget"===g)return a["<$>"](d.functorEither)(c.SetRenderTarget.create)(e[".?"](b.decodeJsonNumber)(f)("target"));if("SetProgram"===g)return a["<$>"](d.functorEither)(c.SetProgram.create)(e[".?"](b.decodeJsonNumber)(f)("program"));if("SetSamplerUniform"===g)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.SetSamplerUniform.create)(e[".?"](b.decodeJsonString)(f)("name")))(e[".?"](b.decodeJsonNumber)(f)("texUnit"));
if("SetTexture"===g)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.SetTexture.create)(e[".?"](b.decodeJsonNumber)(f)("texUnit")))(e[".?"](b.decodeJsonNumber)(f)("tex"));if("SetSampler"===g)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.SetSampler.create)(e[".?"](b.decodeJsonNumber)(f)("texUnit")))(e[".?"](b.decodeJsonMaybe(b.decodeJsonNumber))(f)("sampler"));if("RenderSlot"===g)return a["<$>"](d.functorEither)(c.RenderSlot.create)(e[".?"](b.decodeJsonNumber)(f)("slot"));if("RenderStream"===
g)return a["<$>"](d.functorEither)(c.RenderStream.create)(e[".?"](b.decodeJsonNumber)(f)("stream"));if("ClearRenderTarget"===g)return a["<$>"](d.functorEither)(c.ClearRenderTarget.create)(e[".?"](b.decodeArray(aa))(f)("values"));if("GenerateMipMap"===g)return a["<$>"](d.functorEither)(c.GenerateMipMap.create)(e[".?"](b.decodeJsonNumber)(f)("texUnit"));if("SaveImage"===g)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.SaveImage.create)(e[".?"](b.decodeJsonNumber)(f)("src")))(e[".?"](v)(f)("dst"));
if("LoadImage"===g)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(c.LoadImage.create)(e[".?"](v)(f)("src")))(e[".?"](b.decodeJsonNumber)(f)("dst"));throw Error("Failed pattern match");})})}),ha=new b.DecodeJson(function(f){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(f))(function(f){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(Z))(f)("textures"))(function(v){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(O))(f)("samplers"))(function(g){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(M))(f)("targets"))(function(z){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(F))(f)("programs"))(function(h){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(y))(f)("slots"))(function(J){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(ea))(f)("streams"))(function(k){return a[">>="](d.bindEither)(e[".?"](b.decodeArray(ga))(f)("commands"))(function(b){return a.pure(d.applicativeEither)(new c.Pipeline({textures:v,
samplers:g,targets:z,programs:h,slots:J,streams:k,commands:b}))})})})})})})})})}),ja=new b.DecodeJson(function(c){return a[">>="](d.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(c))(function(c){return a[">>="](d.bindEither)(e[".?"](b.decodeJsonString)(c)("tag"))(function(v){if("Left"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(f.create)(e[".?"](r)(c)("value")))(e[".?"](b.decodeArray(r))(c)("infos"));if("Right"===v)return a["<*>"](d.applyEither)(a["<$>"](d.functorEither)(g.create)(e[".?"](ha)(c)("pipeline")))(e[".?"](b.decodeArray(r))(c)("infos"));
throw Error("Failed pattern match");})})});return{MyLeft:f,MyRight:g,TypeInfo:h,decodeJsonV2:k,decodeJsonV3:t,decodeJsonV4:n,decodeJsonArrayValue:da,decodeJsonValue:q,decodeJsonInputType:B,decodeJsonPointSpriteCoordOrigin:x,decodeJsonPointSize:E,decodeJsonPolygonOffset:K,decodeJsonFrontFace:H,decodeJsonPolygonMode:m,decodeJsonProvokingVertex:w,decodeJsonCullMode:J,decodeJsonComparisonFunction:Q,decodeJsonStencilOperation:A,decodeJsonBlendEquation:Y,decodeJsonBlendingFactor:W,decodeJsonLogicOperation:u,
decodeJsonStencilOps:l,decodeJsonStencilTests:U,decodeJsonStencilTest:R,decodeJsonFetchPrimitive:D,decodeJsonColorArity:S,decodeJsonBlendingFactorPair:X,decodeJsonBlending:ba,decodeJsonRasterContext:P,decodeJsonFragmentOperation:ca,decodeJsonAccumulationContext:fa,decodeJsonTextureDataType:N,decodeJsonTextureType:V,decodeJsonFilter:G,decodeJsonEdgeMode:z,decodeJsonImageRef:v,decodeJsonImageSemantic:I,decodeJsonClearImage:aa,decodeJsonCommand:ga,decodeJsonTextureDescriptor:Z,decodeJsonSamplerDescriptor:O,
decodeJsonParameter:p,decodeJsonProgram:F,decodeJsonSlot:y,decodeJsonStreamData:ea,decodeJsonTargetItem:L,decodeJsonRenderTarget:M,decodeJsonPipeline:ha,decodeJsonTypeInfo:r,decodeJsonMyEither:ja}}();PS=PS||{};
PS.Type=function(){var a=PS.Prelude,b=PS.Data_Array,e=function(){function a(){}a.value=new a;return a}(),c=function(){function a(){}a.value=new a;return a}(),d=function(){function a(){}a.value=new a;return a}(),h=function(){function a(){}a.value=new a;return a}(),f=function(){function a(){}a.value=new a;return a}(),g=function(){function a(){}a.value=new a;return a}(),n=function(){function a(){}a.value=new a;return a}(),t=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),k=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),q=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),r=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),A=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),l=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),w=function(){function a(b){this.value0=
b}a.create=function(b){return new a(b)};return a}(),K=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),x=function(){function a(){}a.value=new a;return a}(),E=function(){function a(){}a.value=new a;return a}(),m=function(){function a(){}a.value=new a;return a}(),u=function(){function a(){}a.value=new a;return a}(),B=function(){function a(){}a.value=new a;return a}(),p=function(){function a(){}a.value=new a;return a}(),F=function(){function a(){}a.value=new a;
return a}(),I=function(){function a(){}a.value=new a;return a}(),v=function(){function a(){}a.value=new a;return a}(),L=function(){function a(){}a.value=new a;return a}(),M=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),H=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),G=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),D=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),y=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),z=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),J=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),P=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Q=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),O=function(){function a(b){this.value0=
b}a.create=function(b){return new a(b)};return a}(),R=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),U=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),S=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),N=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),V=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
Z=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),aa=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),W=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),X=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),Y=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ba=function(){function a(b){this.value0=b}a.create=
function(b){return new a(b)};return a}(),ca=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),da=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ea=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),fa=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ga=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
ha=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),ja=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),va=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),wa=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),C=function(){function a(){}a.value=new a;return a}(),ka=function(){function a(){}a.value=new a;return a}(),la=function(){function a(){}
a.value=new a;return a}(),ma=function(){function a(){}a.value=new a;return a}(),na=function(){function a(){}a.value=new a;return a}(),xa=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),ya=function(){function a(b,c,d,e,f){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return new a(b,c,d,e,f)}}}}};return a}(),
za=function(){function a(b,c,d){this.value0=b;this.value1=c;this.value2=d}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),Aa=function(){function a(b,c,d,e,f){this.value0=b;this.value1=c;this.value2=d;this.value3=e;this.value4=f}a.create=function(b){return function(c){return function(d){return function(e){return function(f){return new a(b,c,d,e,f)}}}}};return a}(),Ba=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,
c)}};return a}(),Ca=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),Da=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),T=function(a){this.toArray=a},Ea=new a.Show(function(a){if(a instanceof e)return"TFloat";if(a instanceof c)return"TV2F";if(a instanceof d)return"TV3F";if(a instanceof h)return"TV4F";if(a instanceof f)return"TM22F";if(a instanceof g)return"TM33F";if(a instanceof n)return"TM44F";
throw Error("Failed pattern match");}),Fa=new a.Show(function(a){if(a instanceof x)return"TriangleStrip";if(a instanceof E)return"TriangleList";if(a instanceof m)return"TriangleFan";if(a instanceof u)return"LineStrip";if(a instanceof B)return"LineList";if(a instanceof p)return"LineLoop";if(a instanceof F)return"PointList";throw Error("Failed pattern match");}),Ga=new T(function(a){return[a]}),oa=new a.Eq(function(b){return function(c){return!a["=="](oa)(b)(c)}},function(a){return function(b){return a instanceof
e&&b instanceof e||a instanceof c&&b instanceof c||a instanceof d&&b instanceof d||a instanceof h&&b instanceof h||a instanceof f&&b instanceof f||a instanceof g&&b instanceof g||a instanceof n&&b instanceof n?!0:!1}}),Ha=new T(function(a){if(a)a=1;else{if(a)throw Error("Failed pattern match");a=0}return[a]});return{SBool:Z,SV2B:aa,SV3B:W,SV4B:X,SInt:Y,SV2I:ba,SV3I:ca,SV4I:da,SFloat:ea,SV2F:fa,SV3F:ga,SV4F:ha,SM22F:ja,SM33F:va,SM44F:wa,GLSetVertexAttribArray:ya,GLDrawArrays:za,GLDrawElements:Aa,GLSetVertexAttrib:Ba,
GLSetUniform:Ca,InputConnection:Da,UniBool:M,UniV2B:H,UniV3B:G,UniV4B:D,UniInt:y,UniV2I:z,UniV3I:J,UniV4I:P,UniFloat:Q,UniV2F:O,UniV3F:R,UniV4F:U,UniM22F:S,UniM33F:N,UniM44F:V,Generate:I,Reorder:v,Ordered:L,TriangleStrip:x,TriangleList:E,TriangleFan:m,LineStrip:u,LineList:B,LineLoop:p,PointList:F,ConstFloat:t,ConstV2F:k,ConstV3F:q,ConstV4F:r,ConstM22F:A,ConstM33F:l,ConstM44F:w,Stream:K,TFloat:e,TV2F:c,TV3F:d,TV4F:h,TM22F:f,TM33F:g,TM44F:n,Array:xa,ArrWord8:C,ArrWord16:ka,ArrInt8:la,ArrInt16:ma,ArrFloat:na,
NumberStorable:T,toArray:function(a){return a.toArray},streamToStreamType:function(a){if(a instanceof t)return e.value;if(a instanceof k)return c.value;if(a instanceof q)return d.value;if(a instanceof r)return h.value;if(a instanceof A)return f.value;if(a instanceof l)return g.value;if(a instanceof w)return n.value;if(a instanceof K)return a.value0.sType;throw Error("Failed pattern match");},sizeOfArrayType:function(a){if(a instanceof C)return 1;if(a instanceof ka)return 2;if(a instanceof la)return 1;
if(a instanceof ma)return 2;if(a instanceof na)return 4;throw Error("Failed pattern match");},eqStreamType:oa,showStreamType:Ea,showPrimitive:Fa,numStorable:Ga,boolStorable:Ha,v2Storable:function(a){return new T(function(c){return b.concatMap(a.toArray)([c.value0,c.value1])})},v3Storable:function(a){return new T(function(c){return b.concatMap(a.toArray)([c.value0,c.value1,c.value2])})},v4Storable:function(a){return new T(function(c){return b.concatMap(a.toArray)([c.value0,c.value1,c.value2,c.value3])})},
arrStorable:function(a){return new T(function(c){return b.concatMap(a.toArray)(c)})}}}();PS=PS||{};
PS.Util=function(){function a(a){return function(b){return function(){a.set(b)}}}function b(a){return function(b){return function(){a.set(b)}}}function e(a){return function(b){return function(c){return function(d){return function(e){return function(f){return function(g){return function(z){return function(){gl.texImage2D(a,b,c,d,e,f,g,z,null)}}}}}}}}}var c=PS.Graphics_WebGLRaw,d=PS.Prelude,h=PS.Control_Monad_Eff_Exception,f=PS.Data_TypedArray,g=PS.Type,n=PS.Data_Array,t=PS.$$Math,k=PS.Data_Foldable,
q=PS.Data_Tuple,r=PS.Control_Monad_Eff,A=PS.Data_Maybe,l=PS.IR,w=function(a){if(0===a.length)return"";if(1===a.length)return a[0];if(1<=a.length){var b=a.slice(1);return a[0]+("\n"+w(b))}throw Error("Failed pattern match");},K=function(a){return function(b){if(a instanceof l.Color)return b instanceof l.FloatT&&b.value0 instanceof l.RGBA||b instanceof l.IntT&&b.value0 instanceof l.RGBA||b instanceof l.WordT&&b.value0 instanceof l.RGBA?d["return"](r.monadEff)(c._RGBA):h.throwException(h.error("FIXME: This texture format is not yet supported"+
d.show(l.showTextureDataType)(b)));if(a instanceof l.Depth)return b instanceof l.FloatT&&b.value0 instanceof l.Red||b instanceof l.WordT&&b.value0 instanceof l.Red?d["return"](r.monadEff)(c._DEPTH_COMPONENT):h.throwException(h.error("FIXME: This texture format is not yet supported"+d.show(l.showTextureDataType)(b)));if(a instanceof l.Stencil)return h.throwException(h.error("FIXME: This texture format is not yet supported"+d.show(l.showTextureDataType)(b)));throw Error("Failed pattern match");}},x=
function(a){return function(b){if(a instanceof l.Color)return b instanceof l.FloatT&&b.value0 instanceof l.RGBA||b instanceof l.IntT&&b.value0 instanceof l.RGBA||b instanceof l.WordT&&b.value0 instanceof l.RGBA?d["return"](r.monadEff)(c._RGBA):h.throwException(h.error("FIXME: This texture format is not yet supported"+d.show(l.showTextureDataType)(b)));if(a instanceof l.Depth)return b instanceof l.FloatT&&b.value0 instanceof l.Red||b instanceof l.WordT&&b.value0 instanceof l.Red?d["return"](r.monadEff)(c._DEPTH_COMPONENT):
h.throwException(h.error("FIXME: This texture format is not yet supported"+d.show(l.showTextureDataType)(b)));if(a instanceof l.Stencil)return h.throwException(h.error("FIXME: This texture format is not yet supported"+d.show(l.showTextureDataType)(b)));throw Error("Failed pattern match");}},E=function(a){return function(b){return c.vertexAttrib4f_(a)(b.value0)(b.value1)(b.value2)(b.value3)}},m=function(a){return function(b){return c.vertexAttrib3f_(a)(b.value0)(b.value1)(b.value2)}},u=function(a){return function(b){return c.vertexAttrib2f_(a)(b.value0)(b.value1)}},
B=function(a){return function(b){return c.vertexAttrib1f_(a)(b)}},p=function(a){if(a instanceof l.Nearest)return c._NEAREST;if(a instanceof l.Linear)return c._LINEAR;if(a instanceof l.NearestMipmapNearest)return c._NEAREST_MIPMAP_NEAREST;if(a instanceof l.NearestMipmapLinear)return c._NEAREST_MIPMAP_LINEAR;if(a instanceof l.LinearMipmapNearest)return c._LINEAR_MIPMAP_NEAREST;if(a instanceof l.LinearMipmapLinear)return c._LINEAR_MIPMAP_LINEAR;throw Error("Failed pattern match");},F=function(a){if(a instanceof
l.Repeat)return c._REPEAT;if(a instanceof l.MirroredRepeat)return c._MIRRORED_REPEAT;if(a instanceof l.ClampToEdge)return c._CLAMP_TO_EDGE;throw Error("Failed pattern match");},I=function(a){return function(b){return function(){c.texParameteri_(a)(c._TEXTURE_WRAP_S)(F(b.value0.samplerWrapS))();var e;if(b.value0.samplerWrapT instanceof A.Nothing)e=d["return"](r.monadEff)(d.unit);else if(b.value0.samplerWrapT instanceof A.Just)e=c.texParameteri_(a)(c._TEXTURE_WRAP_T)(F(b.value0.samplerWrapT.value0));
else throw Error("Failed pattern match");e();c.texParameteri_(a)(c._TEXTURE_MIN_FILTER)(p(b.value0.samplerMinFilter))();return c.texParameteri_(a)(c._TEXTURE_MAG_FILTER)(p(b.value0.samplerMagFilter))()}}};return{edgeModeToGLType:F,filterToGLType:p,setTextureSamplerParameters:I,texImage2DNull_:e,textureDataTypeToGLArityType:x,textureDataTypeToGLType:K,compileTexture:function(a){return function(){var b=c.createTexture_();return function(){var f=function(d){return function(e){return function(){var f=
K(a.value0.textureSemantic)(e)(),g=x(a.value0.textureSemantic)(e)();c.bindTexture_(d)(b)();I(d)(a.value0.textureSampler)();return new q.Tuple(f,g)}}},g=n[".."](a.value0.textureBaseLevel)(a.value0.textureMaxLevel),p=function(a){return function(b){return t.floor(a/b)}},m=function(a){return function(b){return 0===a?[b]:d[":"](b)(m(a-1)(p(b)(2)))}},u=m(a.value0.textureMaxLevel-a.value0.textureBaseLevel);return function(){return a.value0.textureType instanceof l.Texture2D&&1===a.value0.textureType.value1?
function(){if(a.value0.textureSize instanceof l.VV2U){var z=f(c._TEXTURE_2D)(a.value0.textureType.value0)();k.for_(r.applicativeEff)(k.foldableArray)(q.zip(g)(q.zip(u(a.value0.textureSize.value0.value0))(u(a.value0.textureSize.value0.value1))))(function(a){return function(){var b=e(c._TEXTURE_2D)(a.value0)(z.value0)(a.value1.value0)(a.value1.value1)(0)(z.value1),f;if(f=z.value1===c._DEPTH_COMPONENT)f=c._UNSIGNED_SHORT;else{if(f)throw Error("Failed pattern match");f=c._UNSIGNED_BYTE}b(f)();return d.unit}})();
return{textureObject:b,textureTarget:c._TEXTURE_2D}}throw Error("Failed pattern match");}:h.throwException(h.error("Unsupported texture type!"))}()}()()}},bufferSubDataArrayBuffer:function(a){return function(b){return function(c){return function(){gl.bufferSubData(a,b,c)}}}},bufferDataAlloc:function(a){return function(b){return function(c){return function(){gl.bufferData(a,b,c)}}}},nullWebGLBuffer:null,setArrayView:function(a){return function(b){return function(){a.set(b)}}},newFloatView:function(a){return function(b){return function(c){return function(){return new Float32Array(a,
b,c)}}}},newInt16View:function(a){return function(b){return function(c){return function(){return new Int16Array(a,b,c)}}}},newInt8View:function(a){return function(b){return function(c){return function(){return new Int8Array(a,b,c)}}}},newWord16View:function(a){return function(b){return function(c){return function(){return new Uint16Array(a,b,c)}}}},newWord8View:function(a){return function(b){return function(c){return function(){return new Uint8Array(a,b,c)}}}},newArrayBuffer:function(a){return function(){return new ArrayBuffer(a)}},
arrayTypeToGLType:function(a){if(a instanceof g.ArrWord8)return c._UNSIGNED_BYTE;if(a instanceof g.ArrWord16)return c._UNSIGNED_SHORT;if(a instanceof g.ArrInt8)return c._BYTE;if(a instanceof g.ArrInt16)return c._SHORT;if(a instanceof g.ArrFloat)return c._FLOAT;throw Error("Failed pattern match");},primitiveToGLType:function(a){if(a instanceof g.TriangleStrip)return c._TRIANGLE_STRIP;if(a instanceof g.TriangleList)return c._TRIANGLES;if(a instanceof g.TriangleFan)return c._TRIANGLE_FAN;if(a instanceof
g.LineStrip)return c._LINE_STRIP;if(a instanceof g.LineLoop)return c._LINE_LOOP;if(a instanceof g.LineList)return c._LINES;if(a instanceof g.PointList)return c._POINTS;throw Error("Failed pattern match");},setUniform:function(a){return function(b){return b instanceof g.UniBool?c.uniform1iv_(a)(b.value0):b instanceof g.UniV2B?c.uniform2iv_(a)(b.value0):b instanceof g.UniV3B?c.uniform3iv_(a)(b.value0):b instanceof g.UniV4B?c.uniform4iv_(a)(b.value0):b instanceof g.UniInt?c.uniform1iv_(a)(b.value0):
b instanceof g.UniV2I?c.uniform2iv_(a)(b.value0):b instanceof g.UniV3I?c.uniform3iv_(a)(b.value0):b instanceof g.UniV4I?c.uniform4iv_(a)(b.value0):b instanceof g.UniFloat?c.uniform1fv_(a)(b.value0):b instanceof g.UniV2F?c.uniform2fv_(a)(b.value0):b instanceof g.UniV3F?c.uniform3fv_(a)(b.value0):b instanceof g.UniV4F?c.uniform4fv_(a)(b.value0):b instanceof g.UniM22F?c.uniformMatrix2fv_(a)(!1)(b.value0):b instanceof g.UniM33F?c.uniformMatrix3fv_(a)(!1)(b.value0):b instanceof g.UniM44F?c.uniformMatrix4fv_(a)(!1)(b.value0):
h.throwException(h.error("internal error (setUniform)!"))}},setAV4F:E,setAV3F:m,setAV2F:u,setAFloat:B,setVertexAttrib:function(a){return function(b){return b instanceof g.ConstFloat?B(a)(b.value0):b instanceof g.ConstV2F?u(a)(b.value0):b instanceof g.ConstV3F?m(a)(b.value0):b instanceof g.ConstV4F?E(a)(b.value0):b instanceof g.ConstM22F?function(){u(a)(b.value0.value0)();return u(a+1)(b.value0.value1)()}:b instanceof g.ConstM33F?function(){m(a)(b.value0.value0)();m(a+1)(b.value0.value1)();return m(a+
2)(b.value0.value2)()}:b instanceof g.ConstM44F?function(){E(a)(b.value0.value0)();E(a+1)(b.value0.value1)();E(a+2)(b.value0.value2)();return E(a+3)(b.value0.value3)()}:h.throwException(h.error("internal error (setVertexAttrib)!"))}},unlines:w,primitiveToFetchPrimitive:function(a){if(a instanceof g.TriangleStrip||a instanceof g.TriangleList||a instanceof g.TriangleFan)return l.Triangles.value;if(a instanceof g.LineStrip||a instanceof g.LineLoop||a instanceof g.LineList)return l.Lines.value;if(a instanceof
g.PointList)return l.Points.value;throw Error("Failed pattern match");},mkUniformSetter:function(c){if(c instanceof l.Bool)return c=f.asInt32Array([0]),d["return"](r.monadEff)(new q.Tuple(new g.UniBool(c),g.SBool.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.boolStorable)))));if(c instanceof l.V2B)return c=f.asInt32Array(n.replicate(2)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV2B(c),g.SV2B.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v2Storable(g.boolStorable))))));if(c instanceof
l.V3B)return c=f.asInt32Array(n.replicate(3)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV3B(c),g.SV3B.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v3Storable(g.boolStorable))))));if(c instanceof l.V4B)return c=f.asInt32Array(n.replicate(4)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV4B(c),g.SV4B.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v4Storable(g.boolStorable))))));if(c instanceof l.Int)return c=f.asInt32Array([0]),d["return"](r.monadEff)(new q.Tuple(new g.UniInt(c),
g.SInt.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.numStorable)))));if(c instanceof l.V2I)return c=f.asInt32Array(n.replicate(2)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV2I(c),g.SV2I.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v2Storable(g.numStorable))))));if(c instanceof l.V3I)return c=f.asInt32Array(n.replicate(3)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV3I(c),g.SV3I.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v3Storable(g.numStorable))))));if(c instanceof
l.V4I)return c=f.asInt32Array(n.replicate(4)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV4I(c),g.SV4I.create(d["<<<"](d.semigroupoidArr)(b(c))(g.toArray(g.v4Storable(g.numStorable))))));if(c instanceof l.Float)return c=f.asFloat32Array([0]),d["return"](r.monadEff)(new q.Tuple(new g.UniFloat(c),g.SFloat.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.numStorable)))));if(c instanceof l.V2F)return c=f.asFloat32Array(n.replicate(2)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV2F(c),g.SV2F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v2Storable(g.numStorable))))));
if(c instanceof l.V3F)return c=f.asFloat32Array(n.replicate(3)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV3F(c),g.SV3F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v3Storable(g.numStorable))))));if(c instanceof l.V4F)return c=f.asFloat32Array(n.replicate(4)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniV4F(c),g.SV4F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v4Storable(g.numStorable))))));if(c instanceof l.M22F)return c=f.asFloat32Array(n.replicate(4)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniM22F(c),
g.SM22F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v2Storable(g.v2Storable(g.numStorable)))))));if(c instanceof l.M33F)return c=f.asFloat32Array(n.replicate(9)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniM33F(c),g.SM33F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v3Storable(g.v3Storable(g.numStorable)))))));if(c instanceof l.M44F)return c=f.asFloat32Array(n.replicate(16)(0)),d["return"](r.monadEff)(new q.Tuple(new g.UniM44F(c),g.SM44F.create(d["<<<"](d.semigroupoidArr)(a(c))(g.toArray(g.v4Storable(g.v4Storable(g.numStorable)))))));
throw Error("Failed pattern match");},setIntArray:b,setFloatArray:a,toStreamType:function(a){return a instanceof l.Float?d["return"](r.monadEff)(g.TFloat.value):a instanceof l.V2F?d["return"](r.monadEff)(g.TV2F.value):a instanceof l.V3F?d["return"](r.monadEff)(g.TV3F.value):a instanceof l.V4F?d["return"](r.monadEff)(g.TV4F.value):a instanceof l.M22F?d["return"](r.monadEff)(g.TM22F.value):a instanceof l.M33F?d["return"](r.monadEff)(g.TM33F.value):a instanceof l.M44F?d["return"](r.monadEff)(g.TM44F.value):
h.throwException(h.error("invalid Stream Type"))},blendingFactorToGLType:function(a){if(a instanceof l.ConstantAlpha)return c._CONSTANT_ALPHA;if(a instanceof l.ConstantColor)return c._CONSTANT_COLOR;if(a instanceof l.DstAlpha)return c._DST_ALPHA;if(a instanceof l.DstColor)return c._DST_COLOR;if(a instanceof l.One)return c._ONE;if(a instanceof l.OneMinusConstantAlpha)return c._ONE_MINUS_CONSTANT_ALPHA;if(a instanceof l.OneMinusConstantColor)return c._ONE_MINUS_CONSTANT_COLOR;if(a instanceof l.OneMinusDstAlpha)return c._ONE_MINUS_DST_ALPHA;
if(a instanceof l.OneMinusDstColor)return c._ONE_MINUS_DST_COLOR;if(a instanceof l.OneMinusSrcAlpha)return c._ONE_MINUS_SRC_ALPHA;if(a instanceof l.OneMinusSrcColor)return c._ONE_MINUS_SRC_COLOR;if(a instanceof l.SrcAlpha)return c._SRC_ALPHA;if(a instanceof l.SrcAlphaSaturate)return c._SRC_ALPHA_SATURATE;if(a instanceof l.SrcColor)return c._SRC_COLOR;if(a instanceof l.Zero)return c._ZERO;throw Error("Failed pattern match");},blendEquationToGLType:function(a){if(a instanceof l.FuncAdd)return c._FUNC_ADD;
if(a instanceof l.FuncReverseSubtract)return c._FUNC_REVERSE_SUBTRACT;if(a instanceof l.FuncSubtract)return c._FUNC_SUBTRACT;if(a instanceof l.Max||a instanceof l.Min)return c._FUNC_ADD;throw Error("Failed pattern match");},comparisonFunctionToGLType:function(a){if(a instanceof l.Always)return c._ALWAYS;if(a instanceof l.Equal)return c._EQUAL;if(a instanceof l.Gequal)return c._GEQUAL;if(a instanceof l.Greater)return c._GREATER;if(a instanceof l.Lequal)return c._LEQUAL;if(a instanceof l.Less)return c._LESS;
if(a instanceof l.Never)return c._NEVER;if(a instanceof l.Notequal)return c._NOTEQUAL;throw Error("Failed pattern match");}}}();PS=PS||{};
PS.Data=function(){var a=PS.Data_Traversable,b=PS.Type,e=PS.Data_Array,c=PS.Util,d=PS.Data_Tuple,h=PS.Graphics_WebGLRaw,f=PS.Control_Monad_Eff,g=PS.Data_Maybe;return{compileBuffer:function(n){var t=e.append([0])(a.scanl(a.traversableArray)(function(a){return function(c){return a+b.sizeOfArrayType(c.value0)*e.length(c.value1)}})(0)(n)),k=function(){var a=e.last(t);if(a instanceof g.Just)return a.value0;if(a instanceof g.Nothing)return 0;throw Error("Failed pattern match");}();return function(){var g=
c.newArrayBuffer(k)(),r=a["for"](f.applicativeEff)(a.traversableArray)(d.zip(n)(e.take(e.length(n))(t)))(function(a){var d=function(){if(a.value0.value0 instanceof b.ArrWord8)return c.newWord8View;if(a.value0.value0 instanceof b.ArrWord16)return c.newWord16View;if(a.value0.value0 instanceof b.ArrInt8)return c.newInt8View;if(a.value0.value0 instanceof b.ArrInt16)return c.newInt16View;if(a.value0.value0 instanceof b.ArrFloat)return c.newFloatView;throw Error("Failed pattern match");}(),f=e.length(a.value0.value1),
h=f*b.sizeOfArrayType(a.value0.value0);return function(){var b=d(g)(a.value1)(f)();c.setArrayView(b)(a.value0.value1)();return{arrType:a.value0.value0,arrLength:f,arrOffset:a.value1,arrSize:h,arrView:b}}})(),A=h.createBuffer_();h.bindBuffer_(h._ARRAY_BUFFER)(A)();c.bufferDataAlloc(h._ARRAY_BUFFER)(k)(h._STATIC_DRAW)();c.bufferSubDataArrayBuffer(h._ARRAY_BUFFER)(0)(g)();h.bindBuffer_(h._ARRAY_BUFFER)(c.nullWebGLBuffer)();return{arrays:r,glBuffer:A,buffer:g}}}}}();PS=PS||{};
PS.Input=function(){var a=PS.Prelude,b=PS.Data_Traversable,e=PS.Util,c=PS.Data_Array,d=PS.Data_StrMap,h=PS.Data_Foldable,f=PS.Data_Tuple,g=PS.Control_Monad,n=PS.Control_Monad_Eff_Ref,t=PS.Data_Map,k=PS.Control_Monad_Eff_Exception,q=PS.Type,r=PS.Control_Bind,A=PS.Control_Monad_Eff,l=PS.Data_StrMap_Unsafe,w=PS.Data_Maybe,K=PS.IR,x=function(b){return function(b){return function(b){return a["return"](A.monadEff)(a.unit)}}},E=function(c){return function(){var g=b["for"](A.applicativeEff)(b.traversableArray)(c)(function(a){return function(){var b=
e.mkUniformSetter(a.value1)();return new f.Tuple(new f.Tuple(a.value0,b.value0),new f.Tuple(a.value0,b.value1))}})();return function(){var b=a["return"](A.monadEff),c;c=f.unzip(g);c=new f.Tuple(d.fromList(c.value1),d.fromList(c.value0));return b(c)}()()}},m=function(b){return function(b){return function(f){return function(g){var h=function(){var e=d.toList(g.inputUniforms);return a.flip(c.map)(e)(function(a){var c=q.GLSetUniform.create(a.value1);var e=d.lookup(a.value0)(f.uniSetup);if(e instanceof
w.Nothing)a=l.unsafeIndex(b)(a.value0);else if(e instanceof w.Just)a=e.value0;else throw Error("Failed pattern match");return c(a)})}(),k=a.flip(c.map)(d.values(g.inputStreams))(function(a){var b=l.unsafeIndex(f.attributes)(a.slotAttribute);if(b instanceof q.Stream){var c=e.arrayTypeToGLType(b.value0.buffer.arrays[b.value0.arrIdx].arrType);return function(d){return new q.GLSetVertexAttribArray(a.location,b.value0.buffer.glBuffer,d,c,b.value0.buffer.arrays[b.value0.arrIdx].arrOffset+b.value0.start*
d*q.sizeOfArrayType(b.value0.buffer.arrays[b.value0.arrIdx].arrType))}(function(){if(b.value0.sType instanceof q.TFloat)return 1;if(b.value0.sType instanceof q.TV2F)return 2;if(b.value0.sType instanceof q.TV3F)return 3;if(b.value0.sType instanceof q.TV4F||b.value0.sType instanceof q.TM22F)return 4;if(b.value0.sType instanceof q.TM33F)return 9;if(b.value0.sType instanceof q.TM44F)return 16;throw Error("Failed pattern match");}())}return new q.GLSetVertexAttrib(a.location,b)}),n=function(){var a=e.primitiveToGLType(f.primitive),
b=c.concatMap(function(a){return a instanceof q.Stream?[a.value0.length]:[]})(d.values(f.attributes))[0];if(f.indices instanceof w.Nothing)return new q.GLDrawArrays(a,0,b);if(f.indices instanceof w.Just){var b=e.arrayTypeToGLType(f.indices.value0.buffer.arrays[f.indices.value0.arrIdx].arrType),g=f.indices.value0.buffer.arrays[f.indices.value0.arrIdx].arrOffset+f.indices.value0.start*q.sizeOfArrayType(f.indices.value0.buffer.arrays[f.indices.value0.arrIdx].arrType);return new q.GLDrawElements(a,f.indices.value0.length,
b,f.indices.value0.buffer.glBuffer,g)}throw Error("Failed pattern match");}();return c.concat([h,k,[n]])}}}};return{createObjectCommands:m,uniformM44F:function(a){return function(b){b=d.lookup(a)(b);return b instanceof w.Just&&b.value0 instanceof q.SM44F?b.value0.value0:x(a)("M44F")}},uniformV2F:function(a){return function(b){b=d.lookup(a)(b);return b instanceof w.Just&&b.value0 instanceof q.SV2F?b.value0.value0:x(a)("V2F")}},uniformFloat:function(a){return function(b){b=d.lookup(a)(b);return b instanceof
w.Just&&b.value0 instanceof q.SFloat?b.value0.value0:x(a)("Float")}},nullSetter:x,sortSlotObjects:function(d){return h.for_(A.applicativeEff)(h.foldableArray)(d.slotVector)(function(d){return function(){var e=n.readRef(d)();return function(){var g=function(b){return function(c){return a.compare(a.ordNumber)(b.value0)(c.value0)}},h=function(a){var b=n.writeRef(d),f={},h;for(h in e)e.hasOwnProperty(h)&&(f[h]=e[h]);f.sortedObjects=c.sortBy(g)(a);f.orderJob=q.Ordered.value;return b(f)};if(e.orderJob instanceof
q.Ordered)return a["return"](A.monadEff)(a.unit);if(e.orderJob instanceof q.Generate)return function(){var a=b["for"](A.applicativeEff)(b.traversableArray)(t.values(e.objectMap))(function(a){return function(){var b=n.readRef(a.order)();return new f.Tuple(b,a)}})();return h(a)()};if(e.orderJob instanceof q.Reorder)return function(){var a=b["for"](A.applicativeEff)(b.traversableArray)(e.sortedObjects)(function(a){return function(){var b=n.readRef(a.value1.order)();return new f.Tuple(b,a.value1)}})();
return h(a)()};throw Error("Failed pattern match");}()()}})},setScreenSize:function(a){return function(b){return n.writeRef(a.screenSize)(b)}},addObject:function(l){return function(x){return function(p){return function(F){return function(I){return function(v){return function(){h.for_(A.applicativeEff)(h.foldableArray)(v)(function(b){return d.lookup(b)(l.schema.uniforms)instanceof w.Nothing?k.throwException(k.error("Unknown uniform: "+a.show(a.showString)(b))):a["return"](A.monadEff)(a.unit)})();(function(){var b=
d.lookup(x)(l.schema.slots);if(b instanceof w.Nothing)return k.throwException(k.error("Unknown slot: "+x));if(b instanceof w.Just)return function(){g.when(A.monadEff)(a["/="](K.eqFetchPrimitive)(b.value0.primitive)(e.primitiveToFetchPrimitive(p)))(k.throwException(k.error("Primitive mismatch for slot ("+(a.show(a.showString)(x)+(") expected "+(a.show(K.showFetchPrimitive)(b.value0.primitive)+(" but got "+a.show(q.showPrimitive)(p))))))))();var c=a["<$>"](d.functorStrMap)(q.streamToStreamType)(I);
return g.when(A.monadEff)(a["/="](d.eqStrMap(q.eqStreamType))(c)(b.value0.attributes))(k.throwException(k.error(e.unlines(["Attribute stream mismatch for slot ("+(a.show(a.showString)(x)+") expected "),a.show(d.showStrMap(q.showStreamType))(b.value0.attributes)," but got ",a.show(d.showStrMap(q.showStreamType))(c)]))))()};throw Error("Failed pattern match");})()();var L=function(){var b=d.lookup(x)(l.slotMap);if(b instanceof w.Nothing)return k.throwException(k.error("internal error (slot index)"));
if(b instanceof w.Just)return a["return"](A.monadEff)(b.value0);throw Error("Failed pattern match");}()(),M=n.newRef(0)(),H=n.newRef(!0)(),G=n.readRef(l.objSeed)();n.modifyRef(l.objSeed)(a["+"](a.semiringNumber)(1))();var D=r["=<<"](A.bindEff)(E)(b["for"](A.applicativeEff)(b.traversableArray)(v)(function(b){var c=d.lookup(b)(l.schema.uniforms);if(c instanceof w.Nothing)return k.throwException(k.error("internal error (uniform setter not found)"));if(c instanceof w.Just)return a["return"](A.monadEff)(new f.Tuple(b,
c.value0));throw Error("Failed pattern match");}))(),y=n.newRef([[]])();return function(){var d={slot:L,primitive:p,indices:F,attributes:I,uniSetter:D.value0,uniSetup:D.value1,order:M,enabled:H,id:G,commands:y};return function(){n.modifyRef(l.slotVector[L])(function(b){return{objectMap:t.insert(a.ordNumber)(G)(d)(b.objectMap),sortedObjects:[],orderJob:q.Generate.value}})();var e=n.readRef(l.pipelines)(),e=b["for"](A.applicativeEff)(b.traversableArray)(e)(function(b){if(b instanceof w.Nothing)return a["return"](A.monadEff)([]);
if(b instanceof w.Just)return function(){var a=n.readRef(b.value0.input)();if(a instanceof w.Just){if(a.value0.value0.slotMapInputToPipeline[L]instanceof w.Nothing)return[];if(a.value0.value0.slotMapInputToPipeline[L]instanceof w.Just){var e=c.replicate(c.length(b.value0.programs))([]);return h.foldl(h.foldableArray)(function(a){return function(e){return c.updateAt(e)(m({})(l.uniformSetup)(d)(b.value0.programs[e]))(a)}})(e)(b.value0.slotPrograms[a.value0.value0.slotMapInputToPipeline[L].value0])}}throw Error("Failed pattern match");
};throw Error("Failed pattern match");})();n.writeRef(y)(e)();return d}}()()}}}}}}},mkWebGLPipelineInput:function(a){var b=d.size(a.slots),e=d.fromList(f.zip(d.keys(a.slots))(c[".."](0)(b)));return function(){var c=E(d.toList(a.uniforms))(),f=g.replicateM(A.monadEff)(b)(n.newRef({objectMap:t.empty,sortedObjects:[],orderJob:q.Ordered.value}))(),h=n.newRef(0)(),k=n.newRef(new K.V2(0,0))(),m=n.newRef([w.Nothing.value])();return{schema:a,slotMap:e,slotVector:f,objSeed:h,uniformSetter:c.value0,uniformSetup:c.value1,
screenSize:k,pipelines:m}}},mkUniform:E}}();PS=PS||{};
PS.Mesh=function(){var a=PS.Prelude,b=PS.Control_Monad_Eff_Exception,e=PS.Data_StrMap,c=PS.Input,d=PS.Data_Array,h=PS.Data,f=PS.Type,g=PS.Control_Monad_Eff,n=PS.Data_Maybe,t=PS.Data_Tuple,k=function(){function a(){}a.value=new a;return a}(),q=function(){function a(){}a.value=new a;return a}(),r=function(){function a(){}a.value=new a;return a}(),A=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),l=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};
return a}(),w=function(){function a(){}a.value=new a;return a}(),K=function(){function a(){}a.value=new a;return a}(),x=function(){function a(){}a.value=new a;return a}(),E=function(){function a(){}a.value=new a;return a}(),m=function(){function a(){}a.value=new a;return a}(),u=function(){function a(){}a.value=new a;return a}(),B=function(){function a(){}a.value=new a;return a}(),p=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),F=function(){function a(b){this.value0=
b}a.create=function(b){return new a(b)};return a}(),I=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),v=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),L=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),M=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),H=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),
G=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),D=function(a){return function(b){return function(c){return f.Stream.create(function(){if(c instanceof p)return{sType:f.TFloat.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof F)return{sType:f.TV2F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof I)return{sType:f.TV3F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};
if(c instanceof v)return{sType:f.TV4F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof L)return{sType:f.TM22F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof M)return{sType:f.TM33F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof H)return{sType:f.TM44F.value,buffer:a,arrIdx:b,start:0,length:d.length(c.value0)};if(c instanceof G){var e=function(){if(c.value0 instanceof w)return new t.Tuple(f.TFloat.value,1);if(c.value0 instanceof
K)return new t.Tuple(f.TV2F.value,2);if(c.value0 instanceof x)return new t.Tuple(f.TV3F.value,3);if(c.value0 instanceof E)return new t.Tuple(f.TV4F.value,4);if(c.value0 instanceof m)return new t.Tuple(f.TM22F.value,4);if(c.value0 instanceof u)return new t.Tuple(f.TM33F.value,9);if(c.value0 instanceof B)return new t.Tuple(f.TM44F.value,16);throw Error("Failed pattern match");}();return{sType:e.value0,buffer:a,arrIdx:b,start:0,length:d.length(c.value1)/e.value1}}throw Error("Failed pattern match");
}())}}},y=function(a){if(a instanceof p)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.numStorable))(a.value0));if(a instanceof F)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v2Storable(f.numStorable)))(a.value0));if(a instanceof I)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v3Storable(f.numStorable)))(a.value0));if(a instanceof v)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v4Storable(f.numStorable)))(a.value0));if(a instanceof
L)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v2Storable(f.v2Storable(f.numStorable))))(a.value0));if(a instanceof M)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v3Storable(f.v3Storable(f.numStorable))))(a.value0));if(a instanceof H)return f.Array.create(f.ArrFloat.value)(f.toArray(f.arrStorable(f.v4Storable(f.v4Storable(f.numStorable))))(a.value0));if(a instanceof G)return new f.Array(f.ArrFloat.value,a.value1);throw Error("Failed pattern match");};return{P_Points:k,
P_TriangleStrip:q,P_Triangles:r,P_TriangleStripI:A,P_TrianglesI:l,A_Float:p,A_V2F:F,A_V3F:I,A_V4F:v,A_M22F:L,A_M33F:M,A_M44F:H,A_Flat:G,AT_Float:w,AT_V2F:K,AT_V3F:x,AT_V4F:E,AT_M22F:m,AT_M33F:u,AT_M44F:B,meshAttrToStream:D,meshAttrToArray:y,compileMesh:function(b){if(b.gpuData instanceof n.Just)return a["return"](g.monadEff)(b);if(b.gpuData instanceof n.Nothing){var c=function(a){return function(){var b=h.compileBuffer([new f.Array(f.ArrWord16.value,f.toArray(f.arrStorable(f.numStorable))(a))])();
return new n.Just({buffer:b,arrIdx:0,start:0,length:d.length(a)})}};return function(){var m=h.compileBuffer(d.map(y)(e.values(b.attributes)))(),p=function(){if(b.primitive instanceof k)return a["return"](g.monadEff)(new t.Tuple(f.PointList.value,n.Nothing.value));if(b.primitive instanceof q)return a["return"](g.monadEff)(new t.Tuple(f.TriangleStrip.value,n.Nothing.value));if(b.primitive instanceof r)return a["return"](g.monadEff)(new t.Tuple(f.TriangleList.value,n.Nothing.value));if(b.primitive instanceof
A)return a["<$>"](g.functorEff)(t.Tuple.create(f.TriangleStrip.value))(c(b.primitive.value0));if(b.primitive instanceof l)return a["<$>"](g.functorEff)(t.Tuple.create(f.TriangleList.value))(c(b.primitive.value0));throw Error("Failed pattern match");}()();return function(){var c=e.fromList(d.zipWith(function(a){return function(b){return new t.Tuple(b.value0,D(m)(a)(b.value1))}})(d[".."](0)(e.size(b.attributes)))(e.toList(b.attributes))),f={primitive:p.value0,streams:c,indices:p.value1};return a["return"](g.monadEff)(function(){var a=
{},c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);a.gpuData=new n.Just(f);return a}())}()()}}throw Error("Failed pattern match");},addMesh:function(a){return function(f){return function(g){return function(h){if(g.gpuData instanceof n.Nothing)return b.throwException(b.error("addMesh: only compiled mesh with GPUData is supported"));if(g.gpuData instanceof n.Just){var k=e.lookup(f)(a.schema.slots);if(k instanceof n.Nothing)return b.throwException(b.error("addMesh: slot not found"));if(k instanceof n.Just)return c.addObject(a)(f)(g.gpuData.value0.primitive)(g.gpuData.value0.indices)(e.fromList(d.filter(function(a){return e.member(a.value0)(k.value0.attributes)})(e.toList(g.gpuData.value0.streams))))(h)}throw Error("Failed pattern match");
}}}}}}();PS=PS||{};
PS.MeshJsonDecode=function(){var a=PS.Prelude,b=PS.Data_Argonaut_Decode,e=PS.Data_Argonaut,c=PS.Data_Maybe,d=PS.Mesh,h=PS.Data_Either,f=new b.DecodeJson(function(c){return a[">>="](h.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(c))(function(c){return a[">>="](h.bindEither)(e[".?"](b.decodeJsonString)(c)("tag"))(function(f){if("P_Points"===f)return a.pure(h.applicativeEither)(d.P_Points.value);if("P_TriangleStrip"===f)return a.pure(h.applicativeEither)(d.P_TriangleStrip.value);if("P_Triangles"===
f)return a.pure(h.applicativeEither)(d.P_Triangles.value);if("P_TriangleStripI"===f)return a["<$>"](h.functorEither)(d.P_TriangleStripI.create)(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("P_TrianglesI"===f)return a["<$>"](h.functorEither)(d.P_TrianglesI.create)(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));throw Error("Failed pattern match");})})}),g=new b.DecodeJson(function(c){return a[">>="](h.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(c))(function(c){return a[">>="](h.bindEither)(e[".?"](b.decodeJsonString)(c)("tag"))(function(f){if("A_Float"===
f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_Float.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("A_V2F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_V2F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("A_V3F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_V3F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("A_V4F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_V4F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));
if("A_M22F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_M22F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("A_M33F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_M33F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));if("A_M44F"===f)return a["<$>"](h.functorEither)(d.A_Flat.create(d.AT_M44F.value))(e[".?"](b.decodeArray(b.decodeJsonNumber))(c)("values"));throw Error("Failed pattern match");})})}),n=new b.DecodeJson(function(d){return a[">>="](h.bindEither)(b.decodeJson(b.decodeStrMap(b.decodeJsonJson))(d))(function(d){return a[">>="](h.bindEither)(e[".?"](b.decodeStrMap(g))(d)("attributes"))(function(b){return a[">>="](h.bindEither)(e[".?"](f)(d)("primitive"))(function(d){return a.pure(h.applicativeEither)({attributes:b,
primitive:d,gpuData:c.Nothing.value})})})})});return{MeshData:function(a){return a},decodeJsonMeshPrimitive:f,decodeJsonMeshAttribute:g,decodeJsonMesh:n}}();PS=PS||{};PS.Context=function(){var a;try{a=Function("return this")()||(0,eval)("this")}catch(b){a=window}return{getContext:function(){return a}}}();PS=PS||{};
PS.Data_Foreign_OOFFI=function(){var a=PS.Prelude,b=PS.Context,e=PS.Data_Function,c=PS.Control_Monad_Eff,d=e.runFn4(function(a,b,c,d){return function(){return b[a](c,d)}}),h=e.runFn3(function(a,b,c){return function(){return b[a](c)}}),f=a[">>="](c.bindEff)(b.getContext);return{method2EffC:function(a){return function(b){return function(c){return f(function(e){return d(a)(e)(b)(c)})}}},method2Eff:d,method1EffC:function(a){return function(b){return f(function(c){return h(a)(c)(b)})}},method1Eff:h}}();
PS=PS||{};PS.Control_Timer=function(){var a=PS.Data_Foreign_OOFFI,b=PS.Prelude.flip(a.method2EffC("setTimeout"));return{clearTimeout:a.method1EffC("clearTimeout"),timeout:b}}();PS=PS||{};
PS.Backend=function(){var a=PS.Graphics_WebGLRaw,b=PS.Prelude,e=PS.Debug_Trace,c=PS.Util,d=PS.Control_Monad_Eff_Exception,h=PS.Control_Monad,f=PS.Data_StrMap,g=PS.Data_Traversable,n=PS.Data_Array,t=PS.Data_Maybe_Unsafe,k=PS.Data_Maybe,q=PS.Data_Foldable,r=PS.Data_Tuple,A=PS.$$Math,l=PS.Data,w=PS.Control_Monad_Eff_Ref,K=PS.Control_Bind,x=PS.Type,E=PS.Data_Map,m=PS.Input,u=PS.Control_Monad_Eff,B=PS.Data_StrMap_Unsafe,p=PS.IR,F=function(){var c=function(a){if(a instanceof p.ProgramPointSize)return b["return"](u.monadEff)(b.unit);
if(a instanceof p.PointSize)return e.trace("PointSize is not supported!");throw Error("Failed pattern match");},d=function(b){if(b instanceof p.CCW)return a._CCW;if(b instanceof p.CW)return a._CW;throw Error("Failed pattern match");};return function(e){if(e instanceof p.PointCtx)return c(e.value0);if(e instanceof p.LineCtx)return a.lineWidth_(e.value0);if(e instanceof p.TriangleCtx)return function(){(function(){if(e.value0 instanceof p.CullNone)return a.disable_(a._CULL_FACE);if(e.value0 instanceof
p.CullFront)return function(){a.enable_(a._CULL_FACE)();a.cullFace_(a._FRONT)();return a.frontFace_(d(e.value0.value0))()};if(e.value0 instanceof p.CullBack)return function(){a.enable_(a._CULL_FACE)();a.cullFace_(a._BACK)();return a.frontFace_(d(e.value0.value0))()};throw Error("Failed pattern match");})()();a.disable_(a._POLYGON_OFFSET_FILL)();if(e.value2 instanceof p.NoOffset)return b.unit;if(e.value2 instanceof p.Offset)return a.polygonOffset_(e.value2.value0)(e.value2.value1)(),a.enable_(a._POLYGON_OFFSET_FILL)();
throw Error("Failed pattern match");};throw Error("Failed pattern match");}}(),I=function(d){var f=function(d){return function(g){if(1<=g.length){var h=g.slice(1);if(g[0]instanceof p.ColorOp)return function(){(function(){if(g[0].value0 instanceof p.NoBlending)return a.disable_(a._BLEND);if(g[0].value0 instanceof p.BlendLogicOp)return function(){a.disable_(a._BLEND)();return e.trace("not presented: BlendLogicOp")()};if(g[0].value0 instanceof p.Blend)return function(){a.enable_(a._BLEND)();a.blendEquationSeparate_(c.blendEquationToGLType(g[0].value0.value0.colorEq))(c.blendEquationToGLType(g[0].value0.value0.alphaEq))();
a.blendColor_(g[0].value0.value2.value0)(g[0].value0.value2.value1)(g[0].value0.value2.value2)(g[0].value0.value2.value3)();return a.blendFuncSeparate_(c.blendingFactorToGLType(g[0].value0.value1.colorF.value0.src))(c.blendingFactorToGLType(g[0].value0.value1.colorF.value0.dst))(c.blendingFactorToGLType(g[0].value0.value1.alphaF.value0.src))(c.blendingFactorToGLType(g[0].value0.value1.alphaF.value0.dst))()};throw Error("Failed pattern match");})()();(g[0].value1 instanceof p.VBool?a.colorMask_(g[0].value1.value0)(!0)(!0)(!0):
g[0].value1 instanceof p.VV2B?a.colorMask_(g[0].value1.value0.value0)(g[0].value1.value0.value1)(!0)(!0):g[0].value1 instanceof p.VV3B?a.colorMask_(g[0].value1.value0.value0)(g[0].value1.value0.value1)(g[0].value1.value0.value2)(!0):g[0].value1 instanceof p.VV4B?a.colorMask_(g[0].value1.value0.value0)(g[0].value1.value0.value1)(g[0].value1.value0.value2)(g[0].value1.value0.value3):a.colorMask_(!0)(!0)(!0)(!0))();return f(d+1)(h)()}}if(0===g.length)return b["return"](u.monadEff)(b.unit);throw Error("Failed pattern match");
}};return function(b){if(2<=b.length){var d=b.slice(2);if(b[1]instanceof p.DepthOp&&b[0]instanceof p.StencilOp)return f(0)(d)}if(1<=b.length&&(d=b.slice(1),b[0]instanceof p.StencilOp))return f(0)(d);if(1<=b.length){var e=b.slice(1);if(b[0]instanceof p.DepthOp)return function(){a.disable_(a._STENCIL_TEST)();var d=c.comparisonFunctionToGLType(b[0].value0);(function(){var e=d===c.comparisonFunctionToGLType(p.Always.value)&&!1===b[0].value1;if(e)return a.disable_(a._DEPTH_TEST);if(!e)return function(){a.enable_(a._DEPTH_TEST)();
a.depthFunc_(d)();return a.depthMask_(b[0].value1)()};throw Error("Failed pattern match");})()();return f(0)(e)()}}return function(){a.disable_(a._DEPTH_TEST)();a.disable_(a._STENCIL_TEST)();return f(0)(b)()}}(d.value0.accOperations)},v=function(b){return q.for_(u.applicativeEff)(q.foldableArray)(b)(function(b){if(b instanceof x.GLSetVertexAttribArray)return function(){a.bindBuffer_(a._ARRAY_BUFFER)(b.value1)();a.enableVertexAttribArray_(b.value0)();return a.vertexAttribPointer_(b.value0)(b.value2)(b.value3)(!1)(0)(b.value4)()};
if(b instanceof x.GLDrawArrays)return a.drawArrays_(b.value0)(b.value1)(b.value2);if(b instanceof x.GLDrawElements)return function(){a.bindBuffer_(a._ELEMENT_ARRAY_BUFFER)(b.value3)();return a.drawElements_(b.value0)(b.value1)(b.value2)(b.value4)()};if(b instanceof x.GLSetVertexAttrib)return function(){a.disableVertexAttribArray_(b.value0)();return c.setVertexAttrib(b.value0)(b.value1)()};if(b instanceof x.GLSetUniform)return c.setUniform(b.value0)(b.value1);throw Error("Failed pattern match");})},
L=function(a){return function(a){return function(d){return function(e){return function(g){var h=function(){var c=f.toList(g.inputUniforms);return b.flip(n.map)(c)(function(b){return x.GLSetUniform.create(b.value1)(B.unsafeIndex(a)(b.value0))})}(),k=b.flip(n.map)(f.values(g.inputStreams))(function(a){var b=B.unsafeIndex(d)(a.slotAttribute);if(b instanceof x.Stream){var e=c.arrayTypeToGLType(b.value0.buffer.arrays[b.value0.arrIdx].arrType);return function(c){return new x.GLSetVertexAttribArray(a.location,
b.value0.buffer.glBuffer,c,e,b.value0.buffer.arrays[b.value0.arrIdx].arrOffset+b.value0.start*c*x.sizeOfArrayType(b.value0.buffer.arrays[b.value0.arrIdx].arrType))}(function(){if(b.value0.sType instanceof x.TFloat)return 1;if(b.value0.sType instanceof x.TV2F)return 2;if(b.value0.sType instanceof x.TV3F)return 3;if(b.value0.sType instanceof x.TV4F||b.value0.sType instanceof x.TM22F)return 4;if(b.value0.sType instanceof x.TM33F)return 9;if(b.value0.sType instanceof x.TM44F)return 16;throw Error("Failed pattern match");
}())}return new x.GLSetVertexAttrib(a.location,b)}),m=function(){var a=c.primitiveToGLType(e),b=n.concatMap(function(a){return a instanceof x.Stream?[a.value0.length]:[]})(f.values(d))[0];return new x.GLDrawArrays(a,0,b)}();return n.append(n.append(h)(k))([m])}}}}},M=function(a){return function(c){return function(){var e=w.readRef(a.input)();(function(){if(e instanceof k.Nothing)return b["return"](u.monadEff)(b.unit);if(e instanceof k.Just)return function(){w.modifyRef(e.value0.value0.input.pipelines)(function(a){return n.updateAt(e.value0.value0.id)(k.Nothing.value)(a)})();
return q.for_(u.applicativeEff)(q.foldableArray)(e.value0.value0.slotMapPipelineToInput)(function(a){return function(){var b=w.readRef(e.value0.value0.input.slotVector[a])();return q.for_(u.applicativeEff)(q.foldableArray)(E.values(b.objectMap))(function(a){return w.modifyRef(a.commands)(function(a){return n.updateAt(e.value0.value0.id)([])(a)})})()}})()};throw Error("Failed pattern match");})()();if(c instanceof k.Nothing)return w.writeRef(a.input)(k.Nothing.value)();if(c instanceof k.Just){var h=
w.readRef(c.value0.pipelines)(),l=function(){var b=n.findIndex(k.isNothing)(h);if(-1===b){var d=n.length(h);return function(){w.modifyRef(c.value0.pipelines)(function(b){return n.updateAt(d)(new k.Just(a))(n.concat([b,n.replicate(d)(k.Nothing.value)]))})();return new r.Tuple(d,new k.Just(d))}}return function(){w.modifyRef(c.value0.pipelines)(function(c){return n.updateAt(b)(new k.Just(a))(c)})();return new r.Tuple(b,k.Nothing.value)}}()(),p=g["for"](u.applicativeEff)(g.traversableArray)(a.slotNames)(function(a){a=
f.lookup(a)(c.value0.slotMap);if(a instanceof k.Nothing)return d.throwException(d.error("internal error: unknown slot name in input"));if(a instanceof k.Just)return b["return"](u.monadEff)(a.value0);throw Error("Failed pattern match");})();return function(){var b=q.foldr(q.foldableArray)(function(a){return n.updateAt(a.value1)(new k.Just(a.value0))})(n.replicate(f.size(c.value0.slotMap))(k.Nothing.value))(r.zip(n[".."](0)(n.length(p)))(p));return function(){w.writeRef(a.input)(k.Just.create(new x.InputConnection({id:l.value0,
input:c.value0,slotMapPipelineToInput:p,slotMapInputToPipeline:b})))();var d={},e=n.replicate(n.length(a.programs))([]);q.for_(u.applicativeEff)(q.foldableArray)(r.zip(p)(a.slotPrograms))(function(b){return function(){var f=w.readRef(c.value0.slotVector[b.value0])();return q.for_(u.applicativeEff)(q.foldableArray)(E.values(f.objectMap))(function(f){var g=q.foldl(q.foldableArray)(function(b){return function(e){return n.updateAt(e)(m.createObjectCommands(d)(c.value0.uniformSetup)(f)(a.programs[e]))(b)}})(e)(b.value1);
return w.modifyRef(f.commands)(function(a){var b=n.updateAt(l.value0)(g);if(!(l.value1 instanceof k.Nothing))if(l.value1 instanceof k.Just)a=n.concat([a,n.replicate(l.value1.value0)([])]);else throw Error("Failed pattern match");return b(a)})})()}})();return q.for_(u.applicativeEff)(q.foldableArray)(a.streams)(function(b){return w.writeRef(b.commands)(L(d)(c.value0.uniformSetup)(b.attributes)(b.primitive)(a.programs[b.program]))})()}}()()}throw Error("Failed pattern match");}}},H=function(a){return function(){var e=
r.unzip(n.map(function(a){var b=r.Tuple,c=new r.Tuple(a.value1.value0,a.value0);a=a.value1.value1;if(a instanceof p.VFloatArray)a=new x.Array(x.ArrFloat.value,a.value0);else if(a instanceof p.VIntArray)a=new x.Array(x.ArrInt16.value,a.value0);else if(a instanceof p.VWordArray)a=new x.Array(x.ArrWord16.value,a.value0);else throw Error("Failed pattern match");return new b(c,a)})(r.zip(n[".."](0)(f.size(a.value0.streamData)-1))(f.toList(a.value0.streamData))));return function(){var h=function(c){return function(){var e=
function(){var e=f.lookup(c)(a.value0.streamData);return e instanceof k.Just&&e.value0 instanceof p.VFloatArray||e instanceof k.Just&&e.value0 instanceof p.VIntArray||e instanceof k.Just&&e.value0 instanceof p.VWordArray?b["return"](u.monadEff)(n.length(e.value0.value0)):d.throwException(d.error("compileStreamData - getLength"))}()(),g=function(){var e=f.lookup(c)(a.value0.streamType);return e instanceof k.Just&&e.value0 instanceof p.Float?b["return"](u.monadEff)(1):e instanceof k.Just&&e.value0 instanceof
p.V2F?b["return"](u.monadEff)(2):e instanceof k.Just&&e.value0 instanceof p.V3F?b["return"](u.monadEff)(3):e instanceof k.Just&&e.value0 instanceof p.V4F||e instanceof k.Just&&e.value0 instanceof p.M22F?b["return"](u.monadEff)(4):e instanceof k.Just&&e.value0 instanceof p.M33F?b["return"](u.monadEff)(9):e instanceof k.Just&&e.value0 instanceof p.M44F?b["return"](u.monadEff)(16):d.throwException(d.error("compileStreamData - getLength element count"))}()();return A.floor(e/g)}};return function(){var m=
l.compileBuffer(e.value1)(),q=w.newRef([])();return function(){var l=function(e){return function(){var g=K["=<<"](u.bindEff)(c.toStreamType),l;l=f.lookup(e.value0)(a.value0.streamType);if(l instanceof k.Just)l=b["return"](u.monadEff)(l.value0);else if(l instanceof k.Nothing)l=d.throwException(d.error("compileStreamData - toStream"));else throw Error("Failed pattern match");g=g(l)();l=h(e.value0)();return new r.Tuple(e.value0,new x.Stream({sType:g,buffer:m,arrIdx:e.value1,start:0,length:l}))}};return function(){var b=
g.traverse(g.traversableArray)(u.applicativeEff)(l)(e.value0)();return{commands:q,primitive:function(){if(a.value0.streamPrimitive instanceof p.Points)return x.PointList.value;if(a.value0.streamPrimitive instanceof p.Lines)return x.LineList.value;if(a.value0.streamPrimitive instanceof p.Triangles)return x.TriangleList.value;throw Error("Failed pattern match");}(),attributes:f.fromList(b),program:t.fromJust(n.head(a.value0.streamPrograms))}}}()()}}()()}},G=function(c){return function(e){return function(f){var l=
function(a){return a instanceof p.Framebuffer?!0:!1},m=n.map(function(a){return t.fromJust(a.value0.ref)})(n.filter(function(a){return k.isJust(a.value0.ref)})(f.value0.renderTargets));return function(){var t=q.all(q.foldableArray)(l)(m);if(t){var v=function(c){return c.value0.ref instanceof k.Nothing?b["return"](u.monadEff)(a._NONE):c.value0.ref instanceof k.Just&&c.value0.ref.value0 instanceof p.Framebuffer&&c.value0.ref.value0.value0 instanceof p.Color?b["return"](u.monadEff)(a._BACK):d.throwException(d.error("internal error (compileRenderTarget)!"))};
return function(){var a=g.traverse(g.traversableArray)(u.applicativeEff)(v)(n.filter(function(a){a=a.value0.semantic instanceof p.Color?!0:!1;return a})(f.value0.renderTargets))();return{framebufferObject:null,framebufferDrawbuffers:new k.Just(a)}}}if(!t)return function(){h.when(u.monadEff)(q.any(q.foldableArray)(l)(m))(d.throwException(d.error("internal error (compileRenderTarget)!")))();var g=a.createFramebuffer_();a.bindFramebuffer_(a._FRAMEBUFFER)(g)();var n=function(b){return function(f){if(f instanceof
p.TextureImage&&f.value2 instanceof k.Nothing){var g=a.framebufferTexture2D_(a._FRAMEBUFFER)(b)(e[f.value0].textureTarget)(e[f.value0].textureObject)(f.value1);f=c[f.value0].value0.textureType instanceof p.Texture2D&&1===c[f.value0].value0.textureType.value1?g:d.throwException(d.error("invalid texture format!"));return f}return d.throwException(d.error("invalid texture format!"))}};h.foldM(u.monadEff)(function(c){return function(e){return e.value0.semantic instanceof p.Stencil&&e.value0.ref instanceof
k.Just?function(){d.throwException(d.error("Stencil support is not implemented yet!"))();return c}:e.value0.semantic instanceof p.Depth&&e.value0.ref instanceof k.Just?function(){n(a._DEPTH_ATTACHMENT)(e.value0.ref.value0)();return c}:e.value0.semantic instanceof p.Color&&e.value0.ref instanceof k.Just?function(){n(a._COLOR_ATTACHMENT0)(e.value0.ref.value0)();return new r.Tuple(b[":"](a._COLOR_ATTACHMENT0)(c.value0),c.value1+1)}:e.value0.semantic instanceof p.Color&&e.value0.ref instanceof k.Nothing?
b["return"](u.monadEff)(new r.Tuple(b[":"](a._NONE)(c.value0),c.value1+1)):b["return"](u.monadEff)(c)}})(new r.Tuple([],0))(f.value0.renderTargets)();return{framebufferObject:g,framebufferDrawbuffers:k.Nothing.value}};throw Error("Failed pattern match");}()}}},D=function(c){return function(c){return function(){var k=a.createProgram_();return function(){var l=function(b){return function(c){return function(){var f=a.createShader_(c)();a.shaderSource_(f)(b)();a.compileShader_(f)();var g=a.getShaderInfoLog_(f)();
e.trace(g)();g=a.getShaderParameter_(f)(a._COMPILE_STATUS)();h.when(u.monadEff)(!0!==g)(d.throwException(d.error("compileShader failed!")))();a.attachShader_(k)(f)();return f}}};return function(){var m=l(c.value0.vertexShader)(a._VERTEX_SHADER)(),n=l(c.value0.fragmentShader)(a._FRAGMENT_SHADER)();a.linkProgram_(k)();var p=a.getProgramInfoLog_(k)();e.trace(p)();p=a.getProgramParameter_(k)(a._LINK_STATUS)();h.when(u.monadEff)(!0!==p)(d.throwException(d.error("link program failed!")))();var p=b["<$>"](u.functorEff)(f.fromList)(g["for"](u.applicativeEff)(g.traversableArray)(f.toList(c.value0.programUniforms))(function(b){return function(){var c=
a.getUniformLocation_(k)(b.value0)();return new r.Tuple(b.value0,c)}}))(),q=b["<$>"](u.functorEff)(f.fromList)(g["for"](u.applicativeEff)(g.traversableArray)(f.toList(c.value0.programInTextures))(function(b){return function(){var c=a.getUniformLocation_(k)(b.value0)();return new r.Tuple(b.value0,c)}}))(),t=b["<$>"](u.functorEff)(f.fromList)(g["for"](u.applicativeEff)(g.traversableArray)(f.toList(c.value0.programStreams))(function(c){return function(){var d=a.getAttribLocation_(k)(c.value0)();e.trace("attrib location "+
(c.value0+(" "+b.show(b.showNumber)(d))))();return new r.Tuple(c.value0,{location:d,slotAttribute:c.value1.value0.name})}}))();return{program:k,shaders:[m,n],inputUniforms:p,inputSamplers:q,inputStreams:t}}}()()}}},y=function(b){var c=function(b){return function(c){return c.value0.semantic instanceof p.Depth&&c.value0.value instanceof p.VFloat?function(){a.depthMask_(!0)();a.clearDepth_(c.value0.value.value0)();return{mask:b.mask|a._DEPTH_BUFFER_BIT,index:b.index}}:c.value0.semantic instanceof p.Stencil&&
c.value0.value instanceof p.VWord?function(){a.clearStencil_(c.value0.value.value0)();return{mask:b.mask|a._STENCIL_BUFFER_BIT,index:b.index}}:c.value0.semantic instanceof p.Color?function(){(c.value0.value instanceof p.VFloat?a.clearColor_(c.value0.value.value0)(0)(0)(1):c.value0.value instanceof p.VV2F?a.clearColor_(c.value0.value.value0.value0)(c.value0.value.value0.value1)(0)(1):c.value0.value instanceof p.VV3F?a.clearColor_(c.value0.value.value0.value0)(c.value0.value.value0.value1)(c.value0.value.value0.value2)(1):
c.value0.value instanceof p.VV4F?a.clearColor_(c.value0.value.value0.value0)(c.value0.value.value0.value1)(c.value0.value.value0.value2)(c.value0.value.value0.value3):a.clearColor_(0)(0)(0)(1))();a.colorMask_(!0)(!0)(!0)(!0)();return{mask:b.mask|a._COLOR_BUFFER_BIT,index:b.index+1}}:d.throwException(d.error("internal error (clearRenderTarget)"))}};return function(){var d=h.foldM(u.monadEff)(c)({mask:0,index:0})(b)();return a.clear_(d.mask)()}};return{setPipelineInput:M,disposePipeline:function(b){return function(){M(b)(k.Nothing.value)();
return q.for_(u.applicativeEff)(q.foldableArray)(b.programs)(function(b){return function(){a.deleteProgram_(b.program)();return q.traverse_(u.applicativeEff)(q.foldableArray)(a.deleteShader_)(b.shaders)()}})()}},renderSlot:v,renderPipeline:function(c){return function(){w.writeRef(c.curProgram)(k.Nothing.value)();return q.for_(u.applicativeEff)(q.foldableArray)(c.commands)(function(e){return e instanceof p.SetRenderTarget?function(){var d=w.readRef(c.input)();(function(){if(d instanceof k.Nothing)return b["return"](u.monadEff)(b.unit);
if(d instanceof k.Just)return function(){var b=w.readRef(d.value0.value0.input.screenSize)();return a.viewport_(0)(0)(b.value0)(b.value1)()};throw Error("Failed pattern match");})()();return a.bindFramebuffer_(a._FRAMEBUFFER)(c.targets[e.value0].framebufferObject)()}:e instanceof p.SetSamplerUniform?function(){var b=w.readRef(c.curProgram)();if(b instanceof k.Nothing)return d.throwException(d.error("invalid pipeline, no active program"))();if(b instanceof k.Just){b=f.lookup(e.value0)(c.programs[b.value0].inputSamplers);
if(b instanceof k.Nothing)return d.throwException(d.error("internal error (SetSamplerUniform)!"))();if(b instanceof k.Just)return a.uniform1i_(b.value0)(e.value1)()}throw Error("Failed pattern match");}:e instanceof p.SetTexture?function(){a.activeTexture_(a._TEXTURE0+e.value0)();return a.bindTexture_(c.textures[e.value1].textureTarget)(c.textures[e.value1].textureObject)()}:e instanceof p.SetRasterContext?F(e.value0):e instanceof p.SetAccumulationContext?I(e.value0):e instanceof p.ClearRenderTarget?
y(e.value0):e instanceof p.SetProgram?function(){w.writeRef(c.curProgram)(new k.Just(e.value0))();return a.useProgram_(c.programs[e.value0].program)()}:e instanceof p.RenderStream?K["=<<"](u.bindEff)(v)(w.readRef(c.streams[e.value0].commands)):e instanceof p.RenderSlot?function(){var a=w.readRef(c.curProgram)();if(a instanceof k.Nothing)return d.throwException(d.error("invalid pipeline, no active program"))();if(a instanceof k.Just){var f=w.readRef(c.input)();if(f instanceof k.Nothing)return b.unit;
if(f instanceof k.Just){var g=w.readRef(f.value0.value0.input.slotVector[f.value0.value0.slotMapPipelineToInput[e.value0]])();return q.for_(u.applicativeEff)(q.foldableArray)(g.sortedObjects)(function(b){return function(){var c=w.readRef(b.value1.enabled)();return h.when(u.monadEff)(c)(function(){var c=w.readRef(b.value1.commands)();return v(c[f.value0.value0.id][a.value0])()})()}})()}}throw Error("Failed pattern match");}:b["return"](u.monadEff)(b.unit)})()}},allocPipeline:function(b){return function(){a.getExtension_("WEBGL_depth_texture")();
var d=g.traverse(g.traversableArray)(u.applicativeEff)(c.compileTexture)(b.value0.textures)(),e=g.traverse(g.traversableArray)(u.applicativeEff)(G(b.value0.textures)(d))(b.value0.targets)(),h=g.traverse(g.traversableArray)(u.applicativeEff)(D(f.empty))(b.value0.programs)(),l=w.newRef(k.Nothing.value)(),m=w.newRef(k.Nothing.value)(),p=g.traverse(g.traversableArray)(u.applicativeEff)(H)(b.value0.streams)();return{targets:e,textures:d,programs:h,commands:b.value0.commands,input:l,slotPrograms:n.map(function(a){return a.value0.slotPrograms})(b.value0.slots),
slotNames:n.map(function(a){return a.value0.slotName})(b.value0.slots),curProgram:m,streams:p}}},createStreamCommands:L,compileStreamData:H,compileRenderTarget:G,nullWebGLFramebuffer:null,compileProgram:D,clearRenderTarget:y,setupAccumulationContext:I,setupRasterContext:F}}();PS=PS||{};
PS.Sample=function(){var a=PS.Data_StrMap,b=PS.Data_Maybe,e=PS.Data_Tuple,c=PS.IR,d=PS.Mesh,h={attributes:a.fromList([new e.Tuple("position",new d.A_V2F([new c.V2(-1,1),new c.V2(-1,-1),new c.V2(1,-1),new c.V2(1,-1),new c.V2(1,1),new c.V2(-1,1)]))]),primitive:d.P_Triangles.value,gpuData:b.Nothing.value},f=[new c.V4(1,1,-1,1),new c.V4(1,-1,-1,1),new c.V4(-1,-1,-1,1),new c.V4(1,1,-1,1),new c.V4(-1,-1,-1,1),new c.V4(-1,1,-1,1),new c.V4(1,1,-1,1),new c.V4(1,1,1,1),new c.V4(1,-1,1,1),new c.V4(1,1,-1,1),
new c.V4(1,-1,1,1),new c.V4(1,-1,-1,1),new c.V4(1,1,1,1),new c.V4(-1,-1,1,1),new c.V4(1,-1,1,1),new c.V4(1,1,1,1),new c.V4(-1,1,1,1),new c.V4(-1,-1,1,1),new c.V4(-1,1,1,1),new c.V4(-1,-1,-1,1),new c.V4(-1,-1,1,1),new c.V4(-1,1,1,1),new c.V4(-1,1,-1,1),new c.V4(-1,-1,-1,1),new c.V4(1,1,-1,1),new c.V4(-1,1,-1,1),new c.V4(-1,1,1,1),new c.V4(1,1,-1,1),new c.V4(-1,1,1,1),new c.V4(1,1,1,1),new c.V4(1,1,-1,1),new c.V4(1,1,1,1),new c.V4(-1,1,1,1),new c.V4(1,1,-1,1),new c.V4(-1,1,1,1),new c.V4(-1,1,-1,1)],
c=[new c.V2(0,0),new c.V2(0,1),new c.V2(1,1),new c.V2(0,0),new c.V2(1,1),new c.V2(1,0),new c.V2(0,0),new c.V2(1,0),new c.V2(1,1),new c.V2(0,0),new c.V2(1,1),new c.V2(0,1),new c.V2(1,0),new c.V2(0,1),new c.V2(1,1),new c.V2(1,0),new c.V2(0,0),new c.V2(0,1),new c.V2(0,0),new c.V2(1,1),new c.V2(0,1),new c.V2(0,0),new c.V2(1,0),new c.V2(1,1),new c.V2(0,0),new c.V2(1,0),new c.V2(1,1),new c.V2(0,0),new c.V2(1,1),new c.V2(0,1),new c.V2(0,0),new c.V2(0,1),new c.V2(1,1),new c.V2(0,0),new c.V2(1,1),new c.V2(1,
0)],a={attributes:a.fromList([new e.Tuple("position4",new d.A_V4F(f)),new e.Tuple("vertexUV",new d.A_V2F(c))]),primitive:d.P_Triangles.value,gpuData:b.Nothing.value};return{myQuad:h,myCube:a,g_uv_buffer_data:c,g_vertex_buffer_data:f}}();PS=PS||{};PS.Ace_Range=function(){function a(a,e,c,d){return function(){return new (ace.require("ace/range").Range)(a,e,c,d)}}return{create:function(b){return function(e){return function(c){return function(d){return a(b,e,c,d)}}}}}}();PS=PS||{};
PS.Ace_Editor=function(){function a(a){return function(){return a.getSession()}}function b(a,b){return function(){return b.setTheme(a)}}return{setTheme:function(a){return function(c){return b(a,c)}},getSession:function(b){return a(b)}}}();PS=PS||{};
PS.Ace_EditSession=function(){function a(a,b,c){return function(){return c.on(a,function(a){b(a)()})}}function b(a,b){return function(){return b.setValue(a)}}function e(a,b){return function(){return b.setMode(a)}}function c(a){return function(){return a.getValue()}}function d(a,b){return function(){return b.removeMarker(a)}}return{setValue:function(a){return function(c){return b(a,c)}},setMode:function(a){return function(b){return e(a,b)}},removeMarker:function(a){return function(b){return d(a,b)}},
onChange:function(b){return function(c){return a("change",function(a){return c},b)}},getValue:function(a){return c(a)}}}();PS=PS||{};PS.Ace=function(){function a(a,e){return function(){return e.edit(a)}}return{edit:function(b){return function(e){return a(b,e)}},ace:ace}}();PS=PS||{};
PS.Main=function(){function a(a){return function(){var b,c;a.offsetX?(b=a.offsetX,c=a.offsetY):a.layerX&&(b=a.layerX,c=a.layerY);return[b,c]}}function b(a){return function(b){return function(c){return function(d){return function(e){return function(){a.commands.addCommand({name:b,bindKey:{win:c,mac:d},exec:function(a){e(a)()}})}}}}}}function e(a){return function(b){return function(){a.tokenTooltip=new myTokenTooltip(a,b)}}}function c(a,b,c,d,e){return function(){return e.addMarker(a,b,c,d)}}var d=
PS.Prelude,h=PS.Graphics_WebGL,f=PS.Debug_Trace,g=PS.Data_Date,n=PS.Data_StrMap,t=PS.Input,k=PS.Data_Matrix4,q=PS.Data_Vector3,r=PS.Mesh,A=PS.Sample,l=PS.Data_Argonaut,w=PS.Ace,K=PS.Ace_Editor,x=PS.Ace_EditSession,E=PS.DefaultText,m=PS.Control_Monad_Eff_Ref,u=PS.Data_Array,B=PS.Data_Foldable,p=PS.Control_Monad_JQuery,F=PS.WebSocket,I=PS.Backend,v=PS.Control_Timer,L=PS.Control_Bind,M=PS.Ace_Range,H=PS.Control_Monad_Eff,G=PS.Data_Either,D=PS.Data_Maybe,y=PS.Data_Tuple,z=PS.IR,J=PS.Type,P=PS.PipelineJsonDecode,
Q=PS.Data_Argonaut_Decode,O=d["return"](H.monadEff)(d.unit),R=function(a){return function(b){return function(d){return function(e){return function(f){return c(a,b,d,e,f)}}}}};return{run:h.runWebGL("glcanvas")(function(a){return f.trace(a)})(function(c){return function(){var S=g.nowEpochMilliseconds();return function(){var N={slots:n.fromList([new y.Tuple("stream",{primitive:z.Triangles.value,attributes:n.fromList([new y.Tuple("position",J.TV3F.value),new y.Tuple("normal",J.TV3F.value)])}),new y.Tuple("stream4",
{primitive:z.Triangles.value,attributes:n.fromList([new y.Tuple("position4",J.TV4F.value),new y.Tuple("vertexUV",J.TV2F.value)])}),new y.Tuple("line",{primitive:z.Triangles.value,attributes:n.fromList([new y.Tuple("position",J.TV3F.value)])}),new y.Tuple("grid",{primitive:z.Triangles.value,attributes:n.fromList([new y.Tuple("position",J.TV3F.value)])}),new y.Tuple("grid3d",{primitive:z.Points.value,attributes:n.fromList([new y.Tuple("position",J.TV3F.value)])}),new y.Tuple("quad",{primitive:z.Triangles.value,
attributes:n.fromList([new y.Tuple("position",J.TV2F.value)])}),new y.Tuple("cube",{primitive:z.Triangles.value,attributes:n.fromList([new y.Tuple("position",J.TV3F.value),new y.Tuple("normal",J.TV3F.value)])})]),uniforms:n.fromList([new y.Tuple("MVP",z.M44F.value),new y.Tuple("MVP2",z.M44F.value),new y.Tuple("Time",z.Float.value),new y.Tuple("Mouse",z.V2F.value)])};return function(){var n=t.mkWebGLPipelineInput(N)();return function(){var y=function(a){if(16===a.length){var b=new z.V4(a[12],a[13],
a[14],a[15]),c=new z.V4(a[8],a[9],a[10],a[11]),d=new z.V4(a[4],a[5],a[6],a[7]);a=new z.V4(a[0],a[1],a[2],a[3]);return new z.V4(a,d,c,b)}throw Error("Failed pattern match");},J=function(a){return function(){var b=h.getCanvasWidth(c)(),d=h.getCanvasHeight(c)();t.setScreenSize(n)(new z.V2(b,d))();var b=k.makePerspective(30)(b/d)(.1)(100),d=k.makeLookAt(q.vec3(4)(.5)(-.6))(q.vec3(0)(0)(0))(q.vec3(0)(1)(0)),e=k.makeLookAt(q.vec3(3)(1.3)(.3))(q.vec3(0)(0)(0))(q.vec3(0)(1)(0)),f=k.makeRotate(.1308996938995747*
a)(q.vec3(0)(1)(0)),e=k.mul(k.mul(b)(e))(f),b=k.mul(k.mul(b)(d))(f);t.uniformFloat("Time")(n.uniformSetter)(a)();t.uniformM44F("MVP")(n.uniformSetter)(y(e))();return t.uniformM44F("MVP2")(n.uniformSetter)(y(b))()}};return function(){var k=r.compileMesh(A.myCube)();r.addMesh(n)("stream4")(k)([])();k=r.compileMesh(A.myQuad)();r.addMesh(n)("quad")(k)([])();var q=w.edit("editor")(w.ace)(),y=K.getSession(q)();K.setTheme("ace/theme/terminal")(q)();x.setMode("ace/mode/haskell")(y)();x.setValue(E.defaultSrc)(y)();
var N=m.newRef([])(),O=m.newRef([])();return function(){var k=function(a){return function(b){return function(c){return function(d){return a<c||a===c&&b<=d}}}},r=function(a){return function(b){return function(c){return function(d){return a<c||a===c&&b<d}}}},w=function(a){return function(b){return function(){var c=m.readRef(N)();return function(){var e=d.flip(u.filter)(c)(function(c){return k(c.value0.startLine)(c.value0.startColumn)(a)(b)&&r(a)(b)(c.value0.endLine)(c.value0.endColumn)}),f=function(a){return function(b){if(a instanceof
D.Nothing)return new D.Just(b.value0);if(a instanceof D.Just){if(r(a.value0.startLine)(a.value0.startColumn)(b.value0.startLine)(b.value0.startColumn))return new D.Just(b.value0);if(d.otherwise)return new D.Just(a.value0)}throw Error("Failed pattern match");}};return d["return"](H.monadEff)(function(){var a=B.foldl(B.foldableArray)(f)(D.Nothing.value)(e);if(a instanceof D.Nothing)return{startLine:0,startColumn:0,endLine:0,endColumn:0,text:""};if(a instanceof D.Just)return a.value0;throw Error("Failed pattern match");
}())}()()}}};return function(){e(q)(w)();var k=p.body(),r=p.find("#messagepanel")(k)(),u=p.find("#statuspanel")(k)(),A=p.find("#compilebutton")(k)(),E=p.find("#exerciseselect")(k)(),k=p.find("#glcanvas")(k)();d.flip(p.on("mousemove"))(k)(function(b){return function(d){return function(){var d=h.getCanvasWidth(c)(),e=h.getCanvasHeight(c)(),f=a(b)();if(2===f.length)return t.uniformV2F("Mouse")(n.uniformSetter)(new z.V2(f[0]/d,f[1]/e))();throw Error("Failed pattern match");}}})();var C=m.newRef(D.Nothing.value)();
return function(){var a=function(a){return function(){var b=m.readRef(C)();m.writeRef(C)(D.Nothing.value)();(function(){if(b instanceof D.Nothing)return d["return"](H.monadEff)(d.unit);if(b instanceof D.Just)return function(){f.trace("dispose old pipeline")();return I.disposePipeline(b.value0)()};throw Error("Failed pattern match");})()();f.trace("allocate new pipeline")();var c=I.allocPipeline(a)();f.trace("attach pipeline input")();I.setPipelineInput(c)(new D.Just(n))();f.trace("generate object commands")();
t.sortSlotObjects(n)();return m.writeRef(C)(new D.Just(c))()}},c=function(a){return function(){f.trace("compile")();p.setText("Compiling...")(u)();var b=x.getValue(y)();return F.send(a)(b)()}};return function(){F.webSocket("ws://lambdacube3d.com:8001/exerciselist")({onOpen:function(a){return function(){F.send(a)("query")();f.trace("socket1 is ready")();return d.unit}},onMessage:function(a){return function(a){var b=d[">>="](G.bindEither)(l.jsonParser(a))(l.decodeJson(Q.decodeArray(Q.decodeJsonString)));
if(b instanceof G.Left)return f.trace("decode error: "+b.value0);if(b instanceof G.Right)return function(){B.for_(H.applicativeEff)(B.foldableArray)(b.value0)(function(a){return function(){var b=p.create("<option></option>")();p.setText(a)(b)();return p.append(b)(E)()}})();return d.unit};throw Error("Failed pattern match");}},onError:function(a){return function(a){return f.trace(a)}},onClose:f.trace("socket1 is closed")})();var e=F.webSocket("ws://lambdacube3d.com:8001/compile")({onOpen:function(a){return function(){f.trace("socket is ready")();
c(a)();var b=m.newRef(D.Nothing.value)();return x.onChange(y)(function(){var e=m.readRef(b)();if(e instanceof D.Nothing)e=d["return"](H.monadEff)(d.unit);else if(e instanceof D.Just)e=v.clearTimeout(e.value0);else throw Error("Failed pattern match");e();return L["=<<"](H.bindEff)(m.writeRef(b))(d["<$>"](H.functorEff)(D.Just.create)(v.timeout(1E3)(c(a))))()})()}},onClose:f.trace("socket is closed"),onMessage:function(b){return function(b){return function(){f.trace("got response")();var c=d[">>="](G.bindEither)(l.jsonParser(b))(l.decodeJson(P.decodeJsonMyEither));
if(c instanceof G.Left)return f.trace("decode error: "+c.value0)();if(c instanceof G.Right&&c.value0 instanceof P.MyLeft){p.setText("Error")(u)();p.setText(c.value0.value0.value0.text)(r)();var e=M.create(c.value0.value0.value0.startLine-1)(c.value0.value0.value0.startColumn-1)(c.value0.value0.value0.endLine-1)(c.value0.value0.value0.endColumn-1)(),g=m.readRef(O)();B.for_(H.applicativeEff)(B.foldableArray)(g)(function(a){return x.removeMarker(a)(y)})();e=R(e)("lc_error")("text")(!1)(y)();m.writeRef(O)([e])();
m.writeRef(N)(c.value0.value1)();return d.unit}if(c instanceof G.Right&&c.value0 instanceof P.MyRight)return p.setText("Compiled")(u)(),p.setText("No errors.")(r)(),m.writeRef(N)(c.value0.value1)(),e=m.readRef(O)(),B.for_(H.applicativeEff)(B.foldableArray)(e)(function(a){return x.removeMarker(a)(y)})(),m.writeRef(O)([])(),a(c.value0.value0)();throw Error("Failed pattern match");}}},onError:function(a){return function(a){return f.trace("error: "+a)}}})();return function(){if(e instanceof G.Left)return f.trace("error: "+
e.value0);if(e instanceof G.Right)return function(){F.webSocket("ws://lambdacube3d.com:8001/getexercise")({onOpen:function(a){return function(){f.trace("socket2 is ready")();d.flip(p.on("change"))(E)(function(b){return function(b){return function(){var b=p.find(":selected")(E)(),b=p.getText(b)();return F.send(a)(b)()}}})();return d.unit}},onMessage:function(a){return function(a){var b=d[">>="](G.bindEither)(l.jsonParser(a))(l.decodeJson(Q.decodeJsonString));if(b instanceof G.Left)return f.trace("decode error: "+
b.value0);if(b instanceof G.Right)return function(){x.setValue(b.value0)(y)();c(e.value0)();return d.unit};throw Error("Failed pattern match");}},onError:function(a){return function(a){return f.trace(a)}},onClose:f.trace("socket2 is closed")})();d.flip(p.on("click"))(A)(function(a){return function(a){return function(){c(e.value0)();return f.trace("clicked compile")()}}})();b(q)("Compile")("Ctrl-B")("Command-B")(function(a){return c(e.value0)})();var a=function(){var b=g.nowEpochMilliseconds();J((b-
S)/1E3)();b=m.readRef(C)();if(b instanceof D.Nothing)b=d["return"](H.monadEff)(d.unit);else if(b instanceof D.Just)b=I.renderPipeline(b.value0);else throw Error("Failed pattern match");b();return v.timeout(40)(a)()};a();return d.unit};throw Error("Failed pattern match");}()()}}()()}}()()}}()()}}()()}}),main:O}}();PS.Main.main();
